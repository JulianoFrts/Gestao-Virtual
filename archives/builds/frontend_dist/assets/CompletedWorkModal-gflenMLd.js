import{f as fe,r as l,g as je,j as e,B as Q,L as ve,aX as we,Y as Ne,Z as ye,s as j,_ as ke,u as Ce,w as Ee,D as Ae,h as Se,k as Te,l as Ie,m as De,o as Pe,a7 as _e,A as Me,q as I,a4 as pe,$ as Le,bA as Re}from"./index-D951x4H-.js";import{r as Oe,u as $e}from"./xlsx-BBWTpfDg.js";import{C as Fe}from"./card-BTHGlYFz.js";import{S as ie}from"./scroll-area-C9sC2RNd.js";import{u as Ge}from"./useWorkStages-DXnml1Pf.js";import{u as Ke}from"./useTowerProduction-DGhO_ax3.js";import{C as qe,a as We}from"./calendar-MfduwZdl.js";import{S as Be}from"./search-BoEw84GM.js";import{C as Je}from"./calendar-B3GVMfO3.js";import{f as ee}from"./format-CP1OFCPJ.js";import{A as he}from"./activity-BYx2dwgt.js";import{T as ze}from"./trending-up-BwuTo0m4.js";import{A as He,a as Ue}from"./arrow-up-BfG5I1o5.js";import{E as Ve}from"./eye-off-Bbweex62.js";import{R as le,j as Xe,k as Ze,B as Ye}from"./AreaChart-D9h5uedO.js";import{B as Qe}from"./BarChart-DjRXQRXs.js";import{L as et}from"./LineChart-DAkisegE.js";import{L as tt}from"./Line-DWxI2lOG.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]],at=fe("ListFilter",st);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M18.2 12.27 20 6H4l1.8 6.27a1 1 0 0 0 .95.73h10.5a1 1 0 0 0 .96-.73Z",key:"1pledb"}],["path",{d:"M8 13v9",key:"hmv0ci"}],["path",{d:"M16 22v-9",key:"ylnf1u"}],["path",{d:"m9 6 1 7",key:"dpdgam"}],["path",{d:"m15 6-1 7",key:"ls7zgu"}],["path",{d:"M12 6V2",key:"1pj48d"}],["path",{d:"M13 2h-2",key:"mj6ths"}]],it=fe("TowerControl",rt);function Ct({onLoad:D}){const n=l.useRef(null),[B,se]=l.useState(!1),{toast:z}=je(),H=m=>typeof m=="number"?m:typeof m=="string"?parseFloat(m.replace(",",".")):0,J=m=>{if(typeof m=="boolean")return m;if(typeof m=="string"){const C=m.toLowerCase().trim();return C==="true"||C==="verdadeiro"||C==="1"||C==="yes"}return!1},L=async m=>{var U;const C=(U=m.target.files)==null?void 0:U[0];if(!C)return;se(!0);const E=new FileReader;E.onload=f=>{var R;try{const V=(R=f.target)==null?void 0:R.result,v=Oe(V,{type:"binary"});let T=[],d=[];v.SheetNames.forEach(O=>{const $=v.Sheets[O],b=$e.sheet_to_json($);if(b.length===0)return;const ae=b[0],p=Object.keys(ae).map(i=>i.toLowerCase());console.log(`üìÑ Checking Sheet: ${O}`,p),(p.includes("x_coordinate")&&p.includes("y_coordinate")||p.includes("lat")&&p.includes("lng")||p.includes("latitude")&&p.includes("longitude"))&&(console.log(`‚úÖ Found Tower Data in ${O}`),T=b.map(i=>{const te=H(i.x_coordinate||i.lng||i.longitude),y=H(i.y_coordinate||i.lat||i.latitude),F=H(i.object_height||i.object_elevation||i.altitude||i.height||0),P=String(i.object_Id||i.name||i.id||`Tower-${Math.random()}`),Z=J(i.isHidden||i.hidden||"false");return{name:P,coordinates:{lat:y,lng:te,altitude:F},isHidden:Z,properties:i}}).filter(i=>!isNaN(i.coordinates.lat)&&!isNaN(i.coordinates.lng))),(p.includes("from_tower_id")&&p.includes("to_tower_id")||p.includes("from")&&p.includes("to"))&&(console.log(`‚úÖ Found Connections in ${O}`),d=b.map(i=>({from:String(i.from_tower_id||i.from||i.From||""),to:String(i.to_tower_id||i.to||i.To||"")})).filter(i=>i.from&&i.to))}),T.length>0?(D(T,d),z({title:"Projeto Importado",description:`${T.length} torres e ${d.length} conex√µes carregadas.`})):z({title:"Erro na Importa√ß√£o",description:"N√£o foi poss√≠vel encontrar colunas de coordenadas (x_coordinate/y_coordinate) no Excel.",variant:"destructive"})}catch(V){console.error("Erro ao ler Excel:",V),z({title:"Erro ao ler arquivo",description:"Certifique-se que √© um arquivo .xlsx v√°lido.",variant:"destructive"})}finally{se(!1),n.current&&(n.current.value="")}},E.readAsBinaryString(C)};return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",ref:n,style:{display:"none"},onChange:L}),e.jsxs(Q,{variant:"outline",disabled:B,className:"gap-2 bg-blue-950/30 border-blue-900/50 hover:bg-blue-900/50 text-blue-400",onClick:()=>{var m;return(m=n.current)==null?void 0:m.click()},children:[B?e.jsx(ve,{className:"w-4 h-4 animate-spin"}):e.jsx(we,{className:"w-4 h-4"}),"Importar Projeto (Excel)"]})]})}function lt({className:D,date:n,setDate:B}){return e.jsx("div",{className:j("grid gap-2",D),children:e.jsxs(Ne,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(Q,{id:"date",variant:"outline",className:j("w-[300px] justify-start text-left font-normal bg-white/5 border-white/10 hover:bg-white/10 text-white relative",!n&&"text-muted-foreground"),children:[e.jsx(Be,{className:j("absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-emerald-500",!(n!=null&&n.to)&&"text-emerald-100")}),e.jsx(Je,{className:"mr-2 h-4 w-4 text-emerald-500"}),n!=null&&n.from?n.to?e.jsxs(e.Fragment,{children:[ee(n.from,"LLL dd, y")," -"," ",ee(n.to,"LLL dd, y")]}):ee(n.from,"LLL dd, y"):e.jsx("span",{children:"Filtrar por Per√≠odo"})]})}),e.jsx(ke,{className:"w-auto p-0 bg-neutral-950 border-white/10",align:"start",children:e.jsx(qe,{initialFocus:!0,mode:"range",defaultMonth:n==null?void 0:n.from,selected:n,onSelect:B,numberOfMonths:2,className:"text-white bg-neutral-950"})})]})})}const Et=({projectId:D,companyId:n,siteId:B="all",onSelectTower:se,onProjectChange:z,onCompanyChange:H,onOpenChange:J,open:L,hiddenTowerIds:m=new Set,onHiddenTowerIdsChange:C})=>{const[E,U]=l.useState(L||!1);l.useEffect(()=>{L!==void 0&&L!==E&&U(L)},[L]),l.useEffect(()=>{J==null||J(E)},[E,J]);const{profile:f}=Ce(),[R,V]=l.useState(!1),[v,T]=l.useState(n||(f==null?void 0:f.companyId)||null),[d,O]=l.useState(D||null),[$]=l.useState(B);l.useEffect(()=>{n!==void 0&&T(n)},[n]),l.useEffect(()=>{D!==void 0&&O(D)},[D]);const{projects:b}=Ee();l.useEffect(()=>{!n&&(f!=null&&f.companyId)&&!v&&T(f.companyId)},[f==null?void 0:f.companyId,n,v]),l.useEffect(()=>{if(d&&!v&&b&&b.length>0){const t=b.find(a=>a.id===d);t!=null&&t.companyId&&T(t.companyId)}},[d,v,b]),l.useEffect(()=>{},[v,H]),l.useEffect(()=>{},[d,z]);const ae=l.useCallback(t=>{const a=new Set(m);a.has(t)?a.delete(t):a.add(t),C==null||C(a)},[m,C]),{towersByStage:p,isLoading:oe,hasLoaded:X,loadProductionData:i,reset:te}=Ke(),[y,F]=l.useState(null),[P,Z]=l.useState(null),{stages:_,reorderStages:be}=Ge($!=="all"?$:void 0,d||void 0,!0),G=l.useMemo(()=>_,[_]),[x,Y]=l.useState("STAGE"),[M,ge]=l.useState();l.useEffect(()=>{P?Y("TOWER"):y&&Y("STAGE")},[P,y]);const ne=(f==null?void 0:f.isSystemAdmin)||["SUPER_ADMIN_GOD","HELPER_SYSTEM"].includes((f==null?void 0:f.role)||""),re=l.useCallback(async()=>{let t=v;if(!t&&d&&b.length>0){const a=b.find(r=>r.id===d);a!=null&&a.companyId&&(t=a.companyId,T(t))}!d||!t||G.length===0||await i(G,d,$,t)},[d,v,G,$,i,b]);l.useEffect(()=>{if(v){const t=b.filter(a=>a.companyId===v);t.length>0&&!d&&O(t[0].id)}},[v,b,d]),l.useEffect(()=>{te(),F(null)},[d,$,v,te]);const ce=t=>{d&&(F(t),X||re())},K=G,de=async(t,a)=>{if(!ne)return;const r=_.findIndex(u=>u.id===t);if(r===-1)return;const o=[..._],c=a==="up"?r-1:r+1;c<0||c>=_.length||([o[r],o[c]]=[o[c],o[r]],await be(o))};l.useEffect(()=>{E&&!y&&K.length>0&&F(K[0].id)},[E,K,y]),l.useEffect(()=>{var t;if(E&&!X){let a=v;!a&&d&&b.length>0&&(a=((t=b.find(r=>r.id===d))==null?void 0:t.companyId)||null),d&&a&&G.length>0&&re()}},[E,X,d,v,G,re,b]);const s=G.find(t=>t.id===y),q=l.useMemo(()=>y?[...p[y]||[]].sort((a,r)=>{const o=(s==null?void 0:s.productionActivityId)||(s==null?void 0:s.id),c=w=>{const h=w.activityStatuses.find(N=>{var k,S;return N.activityId===o||((k=N.activity)==null?void 0:k.productionActivityId)===o||((S=N.activity)==null?void 0:S.name)&&(s==null?void 0:s.name)&&N.activity.name.trim().toLowerCase()===s.name.trim().toLowerCase()});return h!=null&&h.endDate?new Date(h.endDate).getTime():h!=null&&h.updatedAt?new Date(h.updatedAt).getTime():1/0},u=c(a),g=c(r);return u!==g?u-g:(a.objectSeq||0)-(r.objectSeq||0)}):[],[y,p,s]),xe=l.useMemo(()=>{let t=q;return M!=null&&M.from&&(t=t.filter(a=>{const r=(s==null?void 0:s.productionActivityId)||(s==null?void 0:s.id),o=a.activityStatuses.find(g=>{var w,h;return g.activityId===r||((w=g.activity)==null?void 0:w.productionActivityId)===r||((h=g.activity)==null?void 0:h.name)&&(s==null?void 0:s.name)&&g.activity.name.trim().toLowerCase()===s.name.trim().toLowerCase()});if(!(o!=null&&o.endDate))return!1;const c=new Date(o.endDate),u=new Date(M.from);if(u.setHours(0,0,0,0),M.to){const g=new Date(M.to);return g.setHours(23,59,59,999),c>=u&&c<=g}return c>=u})),t},[q,M,s]),me=l.useMemo(()=>q.filter(t=>m.has(t.objectId)).length,[q,m]),A=l.useMemo(()=>P?q.find(t=>t.objectId===P):null,[P,q]),W=l.useMemo(()=>{let t=[],a=null;if(x==="TOWER"&&A?(t=[A],a=(s==null?void 0:s.productionActivityId)||(s==null?void 0:s.id)||null):x==="STAGE"&&y?(t=p[y]||[],a=(s==null?void 0:s.productionActivityId)||(s==null?void 0:s.id)||null):x==="PROJECT"&&(t=Object.values(p).flat(),t=Array.from(new Map(t.map(w=>[w.objectId,w])).values()),a=null),t.length===0)return{progress:[{name:"S/D",value:0}],production:[{name:"S/D",value:0}],costs:[{name:"S/D",value:0}],summary:{status:"0.0%",duration:"0 dias",cost:"R$ 0,00",productivity:"+0.0%"}};const r={};let o=0,c=0;t.forEach(w=>{w.activityStatuses.filter(N=>{var k;return!a||N.activityId===a||((k=N.activity)==null?void 0:k.productionActivityId)===a}).forEach(N=>{o+=N.progressPercent||0,c+=N.volume||(N.progressPercent?N.progressPercent*.15:0),N.history&&N.history.forEach(k=>{const S=ee(new Date(k.date||Date.now()),"dd/MM");r[S]||(r[S]={progress:0,volume:0,cost:0,count:0}),r[S].progress+=k.progressPercent||0,r[S].volume+=k.volume||(k.progressPercent?.5:0),r[S].cost+=(k.progressPercent||0)*(50+Math.random()*20),r[S].count+=1})})});const u=Object.entries(r).map(([w,h])=>({name:w,value:h.progress/(h.count||1),volume:h.volume,cost:h.cost})).sort((w,h)=>{const[N,k]=w.name.split("/").map(Number),[S,ue]=h.name.split("/").map(Number);return k!==ue?k-ue:N-S}),g=u.length>0?u:[{name:"01/02",value:10,volume:2,cost:500},{name:"02/02",value:45,volume:8,cost:1800},{name:"03/02",value:100,volume:15,cost:3400}];return{progress:g,production:g,costs:g,summary:{status:`${(o/Math.max(1,t.length*(a?1:_.length||5))).toFixed(1)}%`,duration:x==="PROJECT"?"M√∫ltiplos Trechos":x==="STAGE"?"Per√≠odo Ativo":"14 dias",cost:`R$ ${(c*850).toLocaleString()}`,productivity:`+${(Math.random()*8+2).toFixed(1)}%`}}},[x,A,s,p,y,_.length]);return e.jsxs(Ae,{open:E,onOpenChange:U,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(Q,{variant:"outline",className:"bg-black/80 backdrop-blur-md border border-white/10 hover:bg-emerald-500 hover:text-black text-white rounded-full w-12 h-12 p-0 flex items-center justify-center shadow-2xl transition-all group relative",children:[e.jsx(at,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}),K.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-emerald-500 text-black text-[9px] font-black w-5 h-5 flex items-center justify-center rounded-full border-2 border-black",children:K.length})]})}),e.jsxs(Te,{className:"max-w-[95vw] w-[1200px] h-[90vh] p-0 bg-slate-950 border-white/10 overflow-hidden flex flex-col glass-card border-warning/10 shadow-[0_0_50px_rgba(var(--warning),0.05)]",children:[e.jsxs(Ie,{className:"p-4 border-b border-white/5 bg-slate-900/50 flex flex-row items-center justify-between space-y-0 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-warning/10 border border-warning/20 flex items-center justify-center shadow-glow",children:e.jsx(he,{className:"w-6 h-6 text-warning"})}),e.jsxs("div",{children:[e.jsx(De,{className:"text-xl font-black text-white italic tracking-tighter uppercase",children:"Painel de Execu√ß√£o 3D Confirmada"}),e.jsx(Pe,{className:"text-[10px] text-slate-500 font-bold uppercase tracking-widest leading-none mt-1",children:"Monitoramento de Produ√ß√£o e Avan√ßo F√≠sico"})]})]}),e.jsx("div",{className:"flex items-center gap-2 p-4",children:e.jsxs(Q,{onClick:()=>{Y("PROJECT"),F(null),Z(null)},className:j("bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-500 border border-emerald-500/20 font-black text-[9px] uppercase tracking-widest h-10 px-6 rounded-2xl gap-2 transition-all shadow-lg",x==="PROJECT"&&"bg-emerald-500 text-black border-emerald-500 shadow-emerald-500/20"),children:[e.jsx(ze,{className:"w-4 h-4 text-center align-middle"}),"Dash Global do Projeto",e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse ml-1"})]})})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[e.jsx(Q,{variant:"ghost",size:"icon",onClick:()=>V(!R),className:j("absolute top-32 z-20 bg-black/40 border border-white/10 backdrop-blur-xl rounded-full transition-all duration-500 hover:bg-primary/20",R?"left-4":"left-[33.3%] -translate-x-1/2"),children:R?e.jsx(_e,{className:"w-4 h-4"}):e.jsx(We,{className:"w-4 h-4"})}),e.jsxs("aside",{className:j("border-r border-white/10 bg-black/20 flex flex-col transition-all duration-500 ease-in-out overflow-hidden h-full",R?"w-0 opacity-0 pointer-events-none":"w-1/3 opacity-100"),children:[e.jsx("div",{className:"p-4 border-b border-white/5",children:e.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Atividades Ativadas"})}),e.jsx(ie,{className:"flex-1",children:e.jsx("div",{className:"p-3 space-y-2",children:K.length===0?e.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"Nenhuma atividade conclu√≠da para exibir."}):K.map(t=>{var c;const a=((c=p[t.id])==null?void 0:c.length)||0,r=oe,o=y===t.id;return e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>ce(t.id),onKeyDown:u=>u.key==="Enter"&&ce(t.id),className:j("w-full text-left p-4 rounded-xl border transition-all cursor-pointer group relative overflow-hidden",o?"bg-primary/10 border-primary/50 shadow-[0_0_20px_rgba(var(--primary),0.1)]":"bg-white/5 border-white/5 hover:bg-white/10 hover:border-white/10",!d&&"opacity-50 cursor-not-allowed grayscale"),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:j("text-[10px] uppercase tracking-widest font-black transition-colors",o?"text-primary/70":"text-slate-500"),children:"Atividade"}),e.jsx("span",{className:j("text-sm font-bold uppercase tracking-tight",o?"text-primary":"text-slate-300"),children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[ne&&e.jsxs("div",{className:"flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:u=>{u.stopPropagation(),de(t.id,"up")},className:"hover:text-primary transition-colors p-0.5",children:e.jsx(He,{className:"w-3 h-3"})}),e.jsx("button",{onClick:u=>{u.stopPropagation(),de(t.id,"down")},className:"hover:text-primary transition-colors p-0.5",children:e.jsx(Ue,{className:"w-3 h-3"})})]}),o&&e.jsx(Me,{className:"w-4 h-4 text-primary animate-pulse"})]})]}),e.jsx("div",{className:"flex items-center gap-2 relative z-10",children:r?e.jsxs(I,{variant:"outline",className:"border-white/10 bg-blue-500/20 text-blue-400 animate-pulse",children:[e.jsx("span",{className:"inline-block w-3 h-3 border-2 border-blue-400/30 border-t-blue-400 rounded-full animate-spin mr-2"}),"Carregando..."]}):X?e.jsxs(I,{variant:"outline",className:j("border-white/10",a>0?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"),children:[a," Torres Completas"]}):e.jsx(I,{variant:"outline",className:"border-white/10 bg-slate-500/10 text-slate-500",children:"Clique para carregar"})}),o&&e.jsx("div",{className:"absolute inset-0 bg-linear-to-r from-primary/5 to-transparent pointer-events-none"})]},t.id)})})})]}),e.jsxs("main",{className:"flex-1 flex flex-col bg-black/10",children:[e.jsxs("div",{className:"h-[40%] flex flex-col border-b border-warning/20 relative",children:[e.jsxs("div",{className:"p-3 border-b border-white/5 flex justify-between items-center bg-warning/5 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-warning/80",children:["Torres Conclu√≠das (",(s==null?void 0:s.name)||"Selecione",")"]}),me>0&&e.jsxs(I,{variant:"outline",className:"text-[8px] bg-warning/10 text-warning border-warning/20",children:[me," ocultas"]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(lt,{date:M,setDate:ge,className:"w-[300px]"})})]}),e.jsx(ie,{className:"flex-1 p-4 bg-linear-to-b from-warning/[0.02] to-transparent",children:xe.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-500 opacity-60 italic text-sm",children:[e.jsx(it,{className:"w-12 h-12 mb-3 opacity-20"}),e.jsx("p",{children:"Selecione uma atividade para carregar as torres."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:xe.map(t=>{const a=P===t.objectId,r=m.has(t.objectId),o=t.activityStatuses.find(c=>{var u,g,w;return c.activityId===(s==null?void 0:s.productionActivityId)||((g=(u=c.activity)==null?void 0:u.name)==null?void 0:g.trim().toLowerCase())===((w=s==null?void 0:s.name)==null?void 0:w.trim().toLowerCase())});return e.jsxs(Fe,{onClick:c=>{c.stopPropagation(),Z(t.objectId)},className:j("bg-slate-900/40 border-white/5 transition-all group overflow-hidden relative cursor-pointer hover:bg-slate-800/60 hover:border-warning/30",a&&"border-warning/60 bg-warning/[0.05] shadow-[0_0_15px_rgba(var(--warning),0.1)] scale-[1.02]",r&&"opacity-40 grayscale-[0.5]"),children:[e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:j("text-[9px] font-black uppercase tracking-widest bg-warning/5 px-1.5 py-0.5 rounded",r?"text-destructive/60":"text-warning/60"),children:["#",t.objectSeq]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:c=>{c.stopPropagation(),ae(t.objectId)},className:j("p-1 hover:text-white transition-opacity",r?"opacity-100 text-destructive":"opacity-0 group-hover:opacity-100 text-slate-500"),children:r?e.jsx(pe,{className:"w-3 h-3"}):e.jsx(Ve,{className:"w-3 h-3"})}),e.jsx("div",{className:j("rounded-full p-0.5",r?"bg-destructive/20":"bg-green-500"),children:r?e.jsx(pe,{className:"w-2.5 h-2.5 text-destructive font-bold"}):e.jsx(Le,{className:"w-2.5 h-2.5 text-black font-bold"})})]})]}),e.jsx("h4",{className:j("text-lg font-black tracking-tighter italic",r?"text-slate-500 line-through decoration-destructive/30":"text-white"),children:t.objectId}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-[8px] text-slate-500 uppercase font-black tracking-widest",children:[e.jsx("span",{children:r?"Oculta no Mapa":"Conclu√≠do"}),e.jsx("span",{className:"text-white/60",children:o!=null&&o.endDate?ee(new Date(o.endDate),"dd/MM/yy"):"-"})]})]}),a&&e.jsx("div",{className:j("absolute left-0 top-0 bottom-0 w-1",r?"bg-destructive/50":"bg-warning")})]},t.id)})})})]}),e.jsxs("div",{className:"h-[60%] flex border-t border-destructive/20 bg-black/30",children:[e.jsxs("div",{className:"w-1/2 flex flex-col border-r border-white/5 p-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-white/5 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-green-500 rounded-full"}),e.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-slate-200",children:x==="PROJECT"?"Consolidado do Projeto":x==="STAGE"?`Execu√ß√£o: ${s==null?void 0:s.name}`:`Engenharia: ${A==null?void 0:A.objectId}`})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"flex bg-white/5 rounded-lg p-0.5 border border-white/5",children:["STAGE","TOWER"].map(t=>e.jsx("button",{onClick:()=>Y(t),className:j("px-2 py-1 text-[7px] font-black uppercase tracking-tighter rounded-md transition-all",x===t?"bg-primary text-black":"text-slate-500 hover:text-white"),children:t==="STAGE"?"Atividade":"Individual"},t))})})]}),A?e.jsxs("div",{className:"flex-1 flex flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/2 p-3 rounded-lg border border-white/5",children:[e.jsxs("p",{className:"text-[8px] text-slate-500 uppercase font-black mb-1",children:["Status ",x==="TOWER"?"Torre":"M√©dio"]}),e.jsx("p",{className:"text-sm font-bold text-green-400",children:W.summary.status})]}),e.jsxs("div",{className:"bg-white/2 p-3 rounded-lg border border-white/5",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black mb-1",children:"Contexto An√°lise"}),e.jsx("p",{className:"text-sm font-bold text-slate-200",children:W.summary.duration})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 h-32 shrink-0",children:[e.jsxs("div",{className:"bg-black/40 rounded-lg p-2 border border-white/5 flex flex-col",children:[e.jsx("p",{className:"text-[7px] text-slate-500 uppercase font-black mb-1 text-center",children:"Curva Progresso"}),e.jsx("div",{className:"flex-1",children:e.jsx(le,{width:"100%",height:"100%",children:e.jsx(Xe,{data:W.progress,children:e.jsx(Ze,{type:"monotone",dataKey:"value",stroke:"#22c55e",fill:"#22c55e20",strokeWidth:1})})})})]}),e.jsxs("div",{className:"bg-black/40 rounded-lg p-2 border border-white/5 flex flex-col",children:[e.jsx("p",{className:"text-[7px] text-slate-500 uppercase font-black mb-1 text-center",children:"Produ√ß√£o Di√°ria"}),e.jsx("div",{className:"flex-1",children:e.jsx(le,{width:"100%",height:"100%",children:e.jsx(Qe,{data:W.production,children:e.jsx(Ye,{dataKey:"value",fill:"#3b82f6",radius:[1,1,0,0]})})})})]}),e.jsxs("div",{className:"bg-black/40 rounded-lg p-2 border border-white/5 flex flex-col",children:[e.jsx("p",{className:"text-[7px] text-slate-500 uppercase font-black mb-1 text-center",children:"Evolu√ß√£o Custo"}),e.jsx("div",{className:"flex-1",children:e.jsx(le,{width:"100%",height:"100%",children:e.jsx(et,{data:W.costs,children:e.jsx(tt,{type:"step",dataKey:"value",stroke:"#ef4444",strokeWidth:1,dot:!1,onClick:()=>{}})})})})]})]}),e.jsx(ie,{className:"flex-1",children:e.jsxs("div",{className:"space-y-2 pr-2",children:[x==="TOWER"&&(A==null?void 0:A.activityStatuses.map((t,a)=>{var r,o;return e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white/2 border border-white/5 rounded hover:bg-white/4 transition-colors group",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-700 group-hover:bg-primary transition-colors"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-300 uppercase truncate",children:((r=t.activity)==null?void 0:r.name)||"Atividade"}),e.jsxs("p",{className:"text-[8px] text-slate-500",children:["Conclu√≠do por ",((o=t.metadata)==null?void 0:o.leadName)||"Sistema"]})]}),e.jsx(I,{variant:"outline",className:"text-[8px] text-green-500 border-green-500/20 bg-green-500/5",children:"100%"})]},a)})),x==="STAGE"&&q.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/2 border border-white/5 rounded hover:bg-white/4 transition-colors group cursor-pointer",onClick:()=>Z(t.objectId),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-6 h-6 rounded bg-emerald-500/10 flex items-center justify-center text-[10px] font-black text-emerald-500",children:["#",t.objectSeq]}),e.jsx("span",{className:"text-[10px] font-black text-white italic",children:t.objectId})]}),e.jsx(I,{variant:"outline",className:"text-[7px] border-emerald-500/20 text-emerald-400 bg-emerald-500/5 uppercase font-black",children:"Completa"})]},a)),x==="PROJECT"&&_.map((t,a)=>{var r;return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/2 border border-white/5 rounded hover:bg-white/4 transition-colors group cursor-pointer",onClick:()=>{F(t.id),Y("STAGE")},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-glow"}),e.jsx("span",{className:"text-[10px] font-black text-white italic uppercase",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[7px] font-black text-slate-500 uppercase",children:"Progresso"}),e.jsxs(I,{variant:"outline",className:"text-[7px] border-white/10 text-white font-black",children:[((r=p[t.id])==null?void 0:r.length)||0," Torres"]})]})]},a)})]})})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-600 italic text-xs opacity-40",children:"Selecione uma Atividade ou Torre para carregar an√°lise"})]}),e.jsxs("div",{className:"w-1/2 flex flex-col p-4 bg-destructive/5 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-destructive/10 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-destructive rounded-full"}),e.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-slate-200",children:"M√©tricas de Custo & Multas"})]}),e.jsx(I,{variant:"outline",className:"text-[8px] border-destructive/20 text-destructive bg-destructive/5 uppercase font-black tracking-widest",children:"Gest√£o de CAPEX"})]}),A||x!=="TOWER"?e.jsxs("div",{className:"flex-1 flex flex-col gap-6 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-[8px] text-slate-500 uppercase font-black",children:["Custo Total ",x==="TOWER"?"Torre":"Agregado"]}),e.jsx("p",{className:"text-xl font-black text-slate-200 font-mono italic",children:W.summary.cost})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black",children:"Ganho Produtividade"}),e.jsx("p",{className:"text-xl font-black text-green-500 font-mono italic",children:W.summary.productivity})]})]}),e.jsxs("div",{className:"flex-1 p-4 bg-black/40 rounded-2xl border border-destructive/5 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-linear-to-br from-destructive/5 to-transparent opacity-50"}),e.jsx(Re,{className:"w-16 h-16 text-destructive/5 absolute -right-4 -bottom-4 group-hover:scale-110 transition-transform"}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-[9px] font-black text-destructive/80 uppercase tracking-widest",children:"Aloca√ß√£o de Recurso"}),e.jsx(I,{className:"bg-destructive/10 text-destructive border-none text-[8px]",children:"OTIMIZADO"})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-end gap-1 mb-1",children:[e.jsx("span",{className:"text-4xl font-black text-white italic tracking-tighter uppercase font-mono",children:x==="PROJECT"?"R$ 450K":x==="STAGE"?"R$ 32K":"R$ 2.4K"}),e.jsx("span",{className:"text-[10px] text-slate-500 font-bold mb-1.5 uppercase tracking-widest",children:"/ dia m√©dio"})]}),e.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden mt-2 border border-white/5",children:e.jsx("div",{className:"h-full bg-destructive w-[75%] rounded-full shadow-[0_0_8px_rgba(239,68,68,0.5)]"})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[7px] text-slate-600 uppercase font-black mb-0.5",children:"M√£o de Obra"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 font-mono italic",children:x==="PROJECT"?"210.4K":x==="STAGE"?"15.2K":"1.1K"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[7px] text-slate-600 uppercase font-black mb-0.5",children:"Equipamentos"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 font-mono italic",children:x==="PROJECT"?"239.6K":x==="STAGE"?"16.8K":"1.3K"})]})]})]})]}),e.jsxs("div",{className:"p-3 bg-amber-500/5 border border-amber-500/10 rounded-xl flex items-center gap-3",children:[e.jsx("div",{className:"p-1.5 bg-amber-500/20 rounded-lg",children:e.jsx(he,{className:"w-4 h-4 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-amber-500 uppercase",children:"Aten√ß√£o de Custos"}),e.jsx("p",{className:"text-[8px] text-amber-500/60 uppercase font-bold tracking-tight",children:"Varia√ß√£o de +2% no √∫ltimo trecho executado."})]})]})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-700 italic text-xs opacity-30",children:"Aguardando sele√ß√£o de ativo..."})]})]})]})]})]})]})};export{Et as C,Ct as E};
