import{u as ms,b2 as ps,i as hs,d as us,r as d,j as e,O as M,ak as E,ar as ie,e as Be,B as w,aj as P,s as g,b3 as qe,q as u,D as ce,k as ne,l as oe,m as de,o as xe,a_ as D,Y as gs,Z as bs,_ as fs,S as js,G as Ns,H as vs,I as ys,J as U,Q as We,a$ as N,K as Je,A as me,t as z}from"./index-D951x4H-.js";import{u as ws}from"./useAuditLogs-D3Sh0dD4.js";import{C as k,b as H,c as V,d as B,a as F}from"./card-BTHGlYFz.js";import{I as pe}from"./input-dNnkIPn6.js";import{T as he,a as ue,b as v,c as b,d as ge,e as h}from"./table-UwE0Vej1.js";import{T as ks,a as Ss,b as R,c as q}from"./tabs-D3Kawp4S.js";import{C as Cs}from"./calendar-MfduwZdl.js";import{A as I}from"./activity-BYx2dwgt.js";import{S as W}from"./search-BoEw84GM.js";import{E as As}from"./eye-CxUjXe8h.js";import{P as Ze}from"./play-Dfpf5oeu.js";import{C as be}from"./calendar-B3GVMfO3.js";import{T as Ts}from"./triangle-alert-BPKdZxxI.js";import{C as Es}from"./copy-CXglQ41p.js";import{I as Ds}from"./info-MbzHf59N.js";import{f as S}from"./format-CP1OFCPJ.js";import{p as J}from"./pt-BR-B9S-fQgu.js";import"./subDays-HHYU8WMe.js";import"./isSameDay-BB6-IGfB.js";function Zs(){var Re,_e,Ge,$e,Ke,ze;const{profile:Z}=ms(),[Qe,Xe]=ps(),Ye=Qe.get("tab")||"audit",es=hs.value||us("system.is_corporate"),{data:fe=[],isLoading:je,refetch:ss}=ws(es||Z==null?void 0:Z.companyId),[Q,as]=d.useState(""),[n,Ne]=d.useState(null),[_,ve]=d.useState(!1),[ye,we]=d.useState([]),[X,ts]=d.useState(""),[i,ke]=d.useState(null),[f,Se]=d.useState({key:"lastDetectedAt",direction:"desc"}),[m,rs]=d.useState(void 0),[A,Ce]=d.useState(null),[G,Ae]=d.useState(null),[Te,Ee]=d.useState([]),[C,T]=d.useState(!1),[Y,De]=d.useState([]),[Ie,ee]=d.useState(0),[se,Le]=d.useState(!1),[Oe,Me]=d.useState([]),[ae,ls]=d.useState(""),[o,Pe]=d.useState(null),[j,is]=d.useState(null),L=s=>{let a="asc";f&&f.key===s&&f.direction==="asc"&&(a="desc"),Se({key:s,direction:a})},$=s=>{let a="asc";j&&j.key===s&&j.direction==="asc"&&(a="desc"),is({key:s,direction:a})},y=({config:s,columnKey:a})=>!s||s.key!==a?e.jsx(P,{className:"w-3 h-3 opacity-20"}):s.direction==="asc"?e.jsx(me,{className:"w-3 h-3 -rotate-90 text-primary"}):e.jsx(me,{className:"w-3 h-3 rotate-90 text-primary"}),te=s=>{if(!s)return!1;try{const a=new Date(s);return a instanceof Date&&!isNaN(a.getTime())&&a.getFullYear()>1900}catch{return!1}},O=(s,a,t)=>{if(!te(s))return"--";try{return S(new Date(s),a,t)}catch{return"--"}};d.useEffect(()=>{(async()=>{var a;try{const t=await z.get("/testing/routes"),r=((a=t.data)==null?void 0:a.data)||t.data||[];Me(Array.isArray(r)?r:[])}catch(t){console.error("Erro ao carregar histórico de rotas:",t)}})()},[]);const Ue=async()=>{var s;try{const a=new URLSearchParams;m!=null&&m.from&&a.append("startDate",m.from.toISOString()),m!=null&&m.to&&a.append("endDate",m.to.toISOString());const t=await z.get(`/audit/architectural?${a.toString()}`),r=((s=t.data)==null?void 0:s.data)||t.data||[];we(Array.isArray(r)?r:[])}catch(a){console.error("Erro ao carregar histórico de auditoria:",a),N.error("Falha ao atualizar filtros de auditoria.")}};d.useEffect(()=>{Ue()},[m]);const cs=async()=>{var s;ve(!0);try{const a=await z.post("/audit/architectural"),t=((s=a.data)==null?void 0:s.data)||a.data||{},r=t.violations||t||[];we(Array.isArray(r)?r:[]),typeof t.healthScore=="number"&&Ce(t.healthScore),t.bySeverity&&Ae(t.bySeverity),t.topIssues&&Ee(t.topIssues),N.success(`Auditoria concluída! Health Score: ${t.healthScore??"--"}`)}catch(a){console.error(a),N.error("Erro ao executar auditoria.")}finally{ve(!1)}},ns=async()=>{T(!0),De([]),ee(0);try{const s=localStorage.getItem("token")||localStorage.getItem("orion_token");if(console.log("[SSE] Token presente?",!!s,s?`${s.substring(0,20)}...`:"null"),!s){N.error("Token de autenticação não encontrado. Faça login novamente."),T(!1);return}const a="/api/v1",r=`${a.startsWith("http")?a:`${window.location.origin}${a.startsWith("/")?"":"/"}${a}`}/audit/scan-stream?token=${encodeURIComponent(s)}`;console.log("[SSE] URL FINAL:",r);const l=new EventSource(r);l.onmessage=x=>{try{const c=JSON.parse(x.data);De(p=>[...p,{type:c.type,data:c}]),c.type==="violation"&&c.total&&ee(Math.round(c.index/c.total*100)),c.type==="complete"&&(Ce(c.healthScore),Ae(c.bySeverity),Ee(c.topIssues||[]),ee(100),l.close(),T(!1),N.success(`Scan completo! Health Score: ${c.healthScore}`),Ue()),c.type==="error"&&(N.error(c.message),l.close(),T(!1))}catch(c){console.error("Erro ao parsear SSE:",c)}},l.onerror=()=>{l.close(),T(!1),N.error("Conexão com o servidor perdida.")}}catch(s){console.error(s),N.error("Erro ao iniciar streaming."),T(!1)}},os=async()=>{var s;Le(!0);try{const a=await z.get("/testing/routes"),t=((s=a.data)==null?void 0:s.data)||a.data||(Array.isArray(a)?a:[]);Me(Array.isArray(t)?t:[]),N.success("Teste de rotas concluído!")}catch(a){console.error(a),N.error("Erro ao testar rotas.")}finally{Le(!1)}},re=d.useMemo(()=>fe.filter(s=>{var t,r,l,x;const a=Q.toLowerCase();return(((t=s.table_name)==null?void 0:t.toLowerCase())||"").includes(a)||(((r=s.performer_name)==null?void 0:r.toLowerCase())||"").includes(a)||(((l=s.action)==null?void 0:l.toLowerCase())||"").includes(a)||(((x=s.record_id)==null?void 0:x.toLowerCase())||"").includes(a)}),[fe,Q]),He=d.useMemo(()=>{const s=ye.filter(r=>{var x,c,p,K;const l=X.toLowerCase();return(((x=r.file)==null?void 0:x.toLowerCase())||"").includes(l)||(((c=r.violation)==null?void 0:c.toLowerCase())||"").includes(l)||(((p=r.message)==null?void 0:p.toLowerCase())||"").includes(l)||(((K=r.severity)==null?void 0:K.toLowerCase())||"").includes(l)}),a=new Map;s.forEach(r=>{const l=r.suggestion||r.violation;if(!a.has(l))a.set(l,{...r,count:1,files:[r.file]});else{const x=a.get(l);x.count++,x.files.includes(r.file)||x.files.push(r.file),new Date(r.lastDetectedAt)>new Date(x.lastDetectedAt)&&(x.lastDetectedAt=r.lastDetectedAt)}});const t=Array.from(a.values());return f&&t.sort((r,l)=>{const x=r[f.key],c=l[f.key];return x<c?f.direction==="asc"?-1:1:x>c?f.direction==="asc"?1:-1:0}),t},[ye,X,f]),Ve=d.useMemo(()=>{const s=Oe.filter(a=>{var r,l,x;const t=ae.toLowerCase();return(((r=a.route)==null?void 0:r.toLowerCase())||"").includes(t)||(((l=a.status)==null?void 0:l.toLowerCase())||"").includes(t)||(((x=a.suggestion)==null?void 0:x.toLowerCase())||"").includes(t)});return j&&s.sort((a,t)=>{let r=a[j.key],l=t[j.key];return j.key==="latency"&&(r=parseInt(r)||0,l=parseInt(l)||0),r<l?j.direction==="asc"?-1:1:r>l?j.direction==="asc"?1:-1:0}),s},[Oe,ae,j]),le=s=>{switch(s){case"INSERT":return"bg-green-500/10 text-green-500 border-green-500/20";case"UPDATE":return"bg-amber-500/10 text-amber-500 border-amber-500/20";case"DELETE":return"bg-red-500/10 text-red-500 border-red-500/20";default:return"bg-blue-500/10 text-blue-500 border-blue-500/20"}},ds=s=>({users:"Usuários (Sistema)",profiles:"Perfis (Legado)",employees:"Funcionários",teams:"Equipes",projects:"Obras",sites:"Canteiros",permission_matrix:"Matriz SU"})[s]||s,Fe=s=>{switch(s){case"HIGH":return"bg-red-500 text-white shadow-red-500/50";case"MEDIUM":return"bg-amber-500 text-white shadow-amber-500/50";case"LOW":return"bg-blue-500 text-white shadow-blue-500/50";default:return"bg-slate-500 text-white"}},xs=({oldData:s,newData:a})=>{const t=["password","token","secret","credential","auth","senha","key","access_token"],r=(c,p)=>p==null?e.jsx(u,{variant:"outline",className:"text-[10px] opacity-30 border-white/10 font-mono",children:"NULL"}):t.some(K=>c.toLowerCase().includes(K))?e.jsx("span",{className:"text-primary font-mono tracking-widest text-xs",children:"••••••••"}):typeof p=="string"&&p.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?e.jsxs("span",{className:"flex items-center gap-1.5 text-xs font-bold text-foreground",children:[e.jsx(be,{className:"w-3 h-3 text-primary/50"}),S(new Date(p),"dd/MM/yyyy HH:mm:ss",{locale:J})]}):typeof p=="string"&&p.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)?e.jsxs("span",{className:"font-mono text-[10px] bg-black/40 px-1.5 py-0.5 rounded border border-white/5 text-blue-400 group-hover:text-blue-300 transition-colors",title:p,children:[p.substring(0,8),"...",p.substring(p.length-4)]}):typeof p=="boolean"?e.jsx(u,{className:g("text-[9px] font-black uppercase tracking-tighter",p?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:p?"TRUE":"FALSE"}):typeof p=="object"?e.jsx("span",{className:"text-[10px] font-mono text-muted-foreground italic truncate",children:"JSON Object"}):e.jsx("span",{className:"text-xs font-bold text-foreground truncate",children:String(p)});if(!s&&!a)return e.jsx("div",{className:"p-8 text-center text-muted-foreground italic border-2 border-dashed border-white/5 rounded-2xl",children:"Sem dados para comparar"});const x=Array.from(new Set([...Object.keys(s||{}),...Object.keys(a||{})])).filter(c=>JSON.stringify(s==null?void 0:s[c])!==JSON.stringify(a==null?void 0:a[c]));return e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2 -mr-2",children:e.jsx("div",{className:g("grid gap-2 p-1",x.length>4?"grid-cols-1 xl:grid-cols-2":"grid-cols-1"),children:x.length===0?e.jsx("div",{className:"p-10 text-center space-y-2 col-span-full",children:e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-widest font-black opacity-30",children:"Nenhuma alteração detectada nos campos"})}):x.map(c=>e.jsxs("div",{className:"group flex flex-col items-stretch gap-px rounded-lg overflow-hidden border border-white/5 bg-white/2 hover:border-primary/20 transition-all duration-300",children:[e.jsx("div",{className:"p-1.5 bg-black/40 border-b border-white/5 flex items-center justify-between",children:e.jsx("span",{className:"text-[8px] font-black uppercase text-primary/40 tracking-widest group-hover:text-primary transition-colors",children:c})}),e.jsxs("div",{className:"flex-1 grid grid-cols-[1fr_auto_1fr] items-center",children:[e.jsx("div",{className:"p-2 bg-red-500/5 min-h-[40px] flex items-center justify-center",children:r(c,s==null?void 0:s[c])}),e.jsx("div",{className:"flex items-center justify-center px-2 bg-black/20 text-muted-foreground group-hover:text-primary transition-colors",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsx("div",{className:"p-2 bg-green-500/5 min-h-[40px] flex items-center justify-center",children:r(c,a==null?void 0:a[c])})]})]},c))})})};return e.jsxs("div",{className:"space-y-6 animate-fade-in p-2 md:p-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black font-display tracking-tight text-foreground uppercase flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-primary/10",children:e.jsx(M,{className:"w-8 h-8 text-primary"})}),"Central de Segurança"]}),e.jsx("p",{className:"text-muted-foreground mt-1 font-medium italic",children:"Auditoria completa e validações técnicas do sistema Orion."})]})}),e.jsxs(ks,{defaultValue:Ye,className:"w-full",onValueChange:s=>{Xe({tab:s})},children:[e.jsxs(Ss,{className:"glass-card mb-8 p-1 flex justify-start overflow-x-auto gap-2 border-white/5",children:[e.jsxs(R,{value:"audit",className:"gap-2 px-6 py-2",children:[e.jsx(E,{className:"w-4 h-4"})," Trilha do Sistema"]}),e.jsxs(R,{value:"validation",className:"gap-2 px-6 py-2",children:[e.jsx(I,{className:"w-4 h-4"})," Sanidade de Rotas"]}),e.jsxs(R,{value:"standards",className:"gap-2 px-6 py-2",children:[e.jsx(ie,{className:"w-4 h-4"})," Auditoria de Padrões"]}),e.jsxs(R,{value:"gapo",className:"gap-2 px-6 py-2",children:[e.jsx(Be,{className:"w-4 h-4"})," Validação GAPO"]}),e.jsxs(R,{value:"checklist",className:"gap-2 px-6 py-2",children:[e.jsx(M,{className:"w-4 h-4"})," Diretrizes de Segurança"]})]}),e.jsxs(q,{value:"audit",className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"relative w-full md:w-80",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(pe,{placeholder:"Buscar por usuário, tabela ou ação...",className:"industrial-input pl-10",value:Q,onChange:s=>as(s.target.value)})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>ss(),className:"gap-2",children:[e.jsx(P,{className:g("w-4 h-4",je&&"animate-spin")})," ","Atualizar Trilha"]})]}),e.jsxs(k,{className:"glass-card overflow-hidden",children:[e.jsxs(H,{className:"border-b border-white/5",children:[e.jsxs(V,{className:"text-lg flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-primary"}),"Registros do Servidor"]}),e.jsxs(B,{children:["Mostrando os últimos ",re.length," eventos registrados."]})]}),e.jsx(F,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(v,{className:"hover:bg-transparent border-white/5 bg-white/2",children:[e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest pl-6 w-[15%]",children:"Data/Hora"}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest w-[30%]",children:"Usuário / IP"}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest w-[30%]",children:"Módulo / Tabela"}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest w-[15%]",children:"Ação"}),e.jsx(b,{className:"text-right pr-6 font-bold text-[10px] uppercase tracking-widest w-[10%]",children:"Detalhes"})]})}),e.jsx(ge,{children:je?e.jsx(v,{children:e.jsx(h,{colSpan:5,className:"text-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Consultando arquivos de auditoria..."})]})})}):re.length===0?e.jsx(v,{children:e.jsx(h,{colSpan:5,className:"text-center py-20 text-muted-foreground italic font-medium",children:"Nenhum registro encontrado para esta busca."})}):re.map(s=>{var a;return e.jsxs(v,{className:"hover:bg-white/2 border-white/5 transition-colors group",children:[e.jsx(h,{className:"pl-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm text-foreground",children:O(s.performed_at,"dd/MM/yyyy",{locale:J})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:O(s.performed_at,"HH:mm:ss")})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg gradient-primary flex items-center justify-center text-[10px] font-black text-white shrink-0",children:(a=qe(s.performer_name))==null?void 0:a.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-sm text-foreground",children:qe(s.performer_name)}),e.jsx("span",{className:"text-[9px] font-mono text-muted-foreground bg-white/5 px-1 rounded w-fit",children:s.ipAddress||"0.0.0.0"})]})]})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(u,{variant:"outline",className:"text-[10px] font-mono bg-muted/30",children:s.table_name}),s.route&&e.jsx("span",{className:"text-[9px] text-muted-foreground/50 truncate max-w-[150px]",title:s.route,children:s.route})]})}),e.jsx(h,{children:e.jsx(u,{className:g("text-[10px] font-black uppercase tracking-widest border",le(s.action)),children:s.action})}),e.jsx(h,{className:"text-right pr-6",children:e.jsx(w,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity rounded-lg hover:bg-primary/20 hover:text-primary",onClick:()=>Ne(s),children:e.jsx(As,{className:"w-4 h-4"})})})]},s.id)})})]})})})]})]}),e.jsxs(q,{value:"validation",className:"space-y-6",children:[e.jsxs(k,{className:"glass-card",children:[e.jsxs(H,{className:"flex flex-col md:flex-row items-start md:items-center justify-between border-b border-white/5 pb-6 gap-4",children:[e.jsxs("div",{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-blue-500"}),"Diagnóstico de Infraestrutura"]}),e.jsx(B,{children:"Verificação em tempo real de acessibilidade e desempenho de rotas críticas."})]}),e.jsxs("div",{className:"flex w-full md:w-auto items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(pe,{placeholder:"Filtrar rotas ou status...",value:ae,onChange:s=>ls(s.target.value),className:"pl-10 bg-black/20 border-white/10 rounded-xl"})]}),e.jsxs(w,{onClick:os,disabled:se,className:"gap-2 shadow-glow shadow-blue-500/20 bg-blue-600 hover:bg-blue-500 text-white border-0 py-6 px-8 rounded-2xl shrink-0",children:[se?e.jsx(P,{className:"w-4 h-4 animate-spin"}):e.jsx(Ze,{className:"w-4 h-4 shadow-xl"}),"Executar"]})]})]}),e.jsx(F,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(v,{className:"hover:bg-transparent border-white/5 bg-white/2",children:[e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest pl-6 cursor-pointer hover:text-primary transition-colors",onClick:()=>$("status"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Status"," ",e.jsx(y,{config:j,columnKey:"status"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest cursor-pointer hover:text-primary transition-colors",onClick:()=>$("route"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Rota / Endpoint"," ",e.jsx(y,{config:j,columnKey:"route"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest cursor-pointer hover:text-primary transition-colors",onClick:()=>$("latency"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Latência"," ",e.jsx(y,{config:j,columnKey:"latency"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest cursor-pointer hover:text-primary transition-colors",onClick:()=>$("lastCheck"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Checagem"," ",e.jsx(y,{config:j,columnKey:"lastCheck"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest pr-6",children:"Sugestão / Diagnóstico"})]})}),e.jsx(ge,{children:Ve.length===0?e.jsx(v,{children:e.jsx(h,{colSpan:5,className:"text-center py-20 text-muted-foreground italic font-medium border-dashed border-white/5",children:se?"Executando testes...":"Nenhum resultado encontrado para esta pesquisa."})}):Ve.map((s,a)=>e.jsxs(v,{className:"hover:bg-white/5 border-white/5 transition-colors group cursor-pointer",onClick:()=>Pe(s),children:[e.jsx(h,{className:"pl-6 py-4",children:e.jsx(u,{className:g("rounded-lg border-0 font-black text-[10px] uppercase",s.status==="UP"?"bg-green-500/10 text-green-500":s.status==="SECURE"?"bg-blue-500/10 text-blue-500":"bg-red-500/10 text-red-500"),children:s.status==="SECURE"?`SECURE (${s.code})`:s.status})}),e.jsx(h,{className:"font-mono text-xs font-bold text-foreground/80",children:s.route}),e.jsx(h,{className:"font-black text-sm text-foreground",children:s.latency}),e.jsx(h,{className:"text-[10px] text-muted-foreground font-medium",children:s.lastCheck&&te(s.lastCheck)?S(new Date(s.lastCheck),"HH:mm:ss"):"--:--"}),e.jsx(h,{className:"pr-6 text-[11px] text-white/60 font-medium italic truncate max-w-[350px]",title:s.suggestion,children:s.suggestion})]},a))})]})})})]}),e.jsx(ce,{open:!!o,onOpenChange:s=>!s&&Pe(null),children:e.jsxs(ne,{className:"max-w-2xl glass-card border-blue-500/20 bg-background/95 backdrop-blur-xl",children:[e.jsx(oe,{children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:g("p-4 rounded-2xl shadow-glow",(o==null?void 0:o.status)==="UP"?"bg-green-500/10 text-green-500":(o==null?void 0:o.status)==="SECURE"?"bg-blue-500/10 text-blue-500":"bg-red-500/10 text-red-500"),children:e.jsx(I,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsxs(de,{className:"text-2xl font-black uppercase tracking-tight flex items-center gap-3",children:["Diagnóstico de Rota",e.jsx(u,{className:g("rounded-lg border-0 font-black",(o==null?void 0:o.status)==="UP"?"bg-green-500/10 text-green-500":(o==null?void 0:o.status)==="SECURE"?"bg-blue-500/10 text-blue-500":"bg-red-500/10 text-red-500"),children:o==null?void 0:o.status})]}),e.jsxs(xe,{className:"font-mono text-xs font-bold text-blue-400",children:["ENDPOINT: ",o==null?void 0:o.route]})]})]})}),o&&e.jsxs("div",{className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-6 rounded-2xl bg-black/20 border border-white/5 space-y-1",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Velocidade de Resposta"}),e.jsx("p",{className:"text-3xl font-black text-foreground",children:o.latency})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-black/20 border border-white/5 space-y-1",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Última Verificação"}),e.jsx("p",{className:"text-3xl font-black text-foreground",children:o.lastCheck&&te(o.lastCheck)?S(new Date(o.lastCheck),"HH:mm:ss"):"--:--"})]})]}),e.jsxs("div",{className:"p-8 rounded-3xl bg-blue-500/5 border border-blue-500/20 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-blue-400 fill-blue-400"}),e.jsx("span",{className:"text-xs font-black text-blue-400 uppercase tracking-widest",children:"Análise do Sistema"})]}),e.jsxs("p",{className:"text-lg font-medium text-foreground leading-relaxed italic",children:['"',o.suggestion,'"']})]}),e.jsx("div",{className:"p-4 rounded-xl bg-black/10 text-[10px] text-muted-foreground italic font-medium",children:"* Este diagnóstico é gerado em tempo real através de pings sintéticos originados do servidor de aplicação."})]})]})})]}),e.jsxs(q,{value:"standards",className:"space-y-6",children:[A!==null&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(k,{className:g("glass-card border-2 col-span-1 md:col-span-1 flex flex-col items-center justify-center py-8",A>=80?"border-green-500/30 bg-green-500/5":A>=50?"border-amber-500/30 bg-amber-500/5":"border-red-500/30 bg-red-500/5"),children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-muted-foreground mb-2",children:"Health Score"}),e.jsx("span",{className:g("text-6xl font-black",A>=80?"text-green-500":A>=50?"text-amber-500":"text-red-500"),children:A}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"de 100"})]}),G&&e.jsxs(k,{className:"glass-card border-white/10 col-span-1 md:col-span-1 p-6",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-muted-foreground mb-4 block",children:"Por Severidade"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u,{className:"bg-red-500/20 text-red-500 border-0",children:"ALTA"}),e.jsx("span",{className:"font-black text-lg",children:G.HIGH})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u,{className:"bg-amber-500/20 text-amber-500 border-0",children:"MÉDIA"}),e.jsx("span",{className:"font-black text-lg",children:G.MEDIUM})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u,{className:"bg-blue-500/20 text-blue-500 border-0",children:"BAIXA"}),e.jsx("span",{className:"font-black text-lg",children:G.LOW})]})]})]}),Te.length>0&&e.jsxs(k,{className:"glass-card border-white/10 col-span-1 md:col-span-2 p-6",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-muted-foreground mb-4 block",children:"Top Code Smells"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Te.map((s,a)=>e.jsx(u,{variant:"outline",className:"text-xs font-medium border-amber-500/30 text-amber-400 bg-amber-500/5",children:s},a))})]})]}),e.jsxs(k,{className:"glass-card border-amber-500/20 bg-amber-500/5 shadow-2xl",children:[e.jsxs(H,{className:"flex flex-col md:flex-row items-start md:items-center justify-between border-b border-amber-500/10 pb-6 gap-4",children:[e.jsxs("div",{children:[e.jsxs(V,{className:"flex items-center gap-3 text-amber-500 font-black text-2xl uppercase tracking-tighter",children:[e.jsx(ie,{className:"w-8 h-8 drop-shadow-glow"}),"AUDITORIA ATIVA"]}),e.jsx(B,{className:"text-amber-500/60 font-bold uppercase text-[10px] tracking-widest",children:"Análise estática de código para conformidade estrutural."})]}),e.jsxs("div",{className:"flex w-full md:w-auto items-center gap-3",children:[e.jsxs(gs,{children:[e.jsx(bs,{asChild:!0,children:e.jsxs(w,{variant:"outline",className:g("w-[240px] justify-start text-left font-normal border-amber-500/20 bg-amber-500/5 hover:bg-amber-500/10 text-amber-100",!m&&"text-muted-foreground"),children:[e.jsx(be,{className:"mr-2 h-4 w-4 text-amber-500"}),m!=null&&m.from?m.to?e.jsxs(e.Fragment,{children:[S(m.from,"dd/MM/yy")," -"," ",S(m.to,"dd/MM/yy")]}):S(m.from,"dd/MM/yy"):e.jsx("span",{children:"Filtrar por Data"})]})}),e.jsx(fs,{className:"w-auto p-0",align:"end",children:e.jsx(Cs,{initialFocus:!0,mode:"range",defaultMonth:m==null?void 0:m.from,selected:m,onSelect:s=>rs(s),numberOfMonths:2})})]}),e.jsx("div",{className:"w-[200px]",children:e.jsxs(js,{onValueChange:s=>{const[a,t]=s.split("-");Se({key:a,direction:t})},defaultValue:"lastDetectedAt-desc",children:[e.jsx(Ns,{className:"border-amber-500/20 bg-amber-500/5 text-amber-100",children:e.jsx(vs,{placeholder:"Ordenação"})}),e.jsxs(ys,{children:[e.jsx(U,{value:"lastDetectedAt-desc",children:"Mais Recentes"}),e.jsx(U,{value:"lastDetectedAt-asc",children:"Mais Antigos"}),e.jsx(U,{value:"severity-desc",children:"Maior Severidade"}),e.jsx(U,{value:"severity-asc",children:"Menor Severidade"}),e.jsx(U,{value:"file-asc",children:"Nome do Arquivo (A-Z)"})]})]})}),e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-500/50"}),e.jsx(pe,{placeholder:"Filtrar arquivos ou violações...",value:X,onChange:s=>ts(s.target.value),className:"pl-10 bg-amber-500/10 border-amber-500/20 rounded-xl text-amber-100 placeholder:text-amber-500/40"})]}),e.jsxs(w,{onClick:cs,disabled:_||C,variant:"destructive",className:"gap-2 shadow-2xl shadow-red-600/30 font-black py-7 px-10 rounded-2xl text-lg uppercase tracking-widest scale-100 hover:scale-105 active:scale-95 transition-all shrink-0",children:[_?e.jsx(P,{className:"w-6 h-6 animate-spin"}):e.jsx(D,{className:"w-6 h-6 fill-current"}),"SCAN"]}),e.jsxs(w,{onClick:ns,disabled:_||C,className:"gap-2 shadow-2xl shadow-green-600/30 font-black py-7 px-8 rounded-2xl text-lg uppercase tracking-widest scale-100 hover:scale-105 active:scale-95 transition-all shrink-0 bg-green-600 hover:bg-green-500 text-white border-0",children:[C?e.jsx(P,{className:"w-6 h-6 animate-spin"}):e.jsx(Ze,{className:"w-6 h-6 fill-current"}),"LIVE"]})]})]}),(C||Y.length>0)&&e.jsxs("div",{className:"px-6 py-5 border-b border-amber-500/10 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:C?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-green-500/10 border border-green-500/30",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-green-500",children:"STREAMING AO VIVO"})]}):e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/10 border border-amber-500/30",children:[e.jsx(Be,{className:"w-3 h-3 text-amber-500"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-amber-500",children:"SCAN CONCLUÍDO"})]})}),e.jsx("div",{className:"flex items-center gap-4",children:(()=>{const s=Y.filter(l=>l.type==="violation"),a=s.filter(l=>l.data.severity==="HIGH").length,t=s.filter(l=>l.data.severity==="MEDIUM").length,r=s.filter(l=>l.data.severity==="LOW").length;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{className:"text-xs font-bold text-red-400",children:a})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),e.jsx("span",{className:"text-xs font-bold text-amber-400",children:t})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-xs font-bold text-blue-400",children:r})]}),e.jsxs("div",{className:"text-xs text-muted-foreground font-medium",children:["Total: ",s.length]})]})})()})]}),C&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Analisando arquivos..."}),e.jsxs("span",{className:"font-black text-primary",children:[Ie,"%"]})]}),e.jsx("div",{className:"h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:e.jsx("div",{className:"h-full bg-linear-to-r from-amber-500 via-orange-500 to-red-500 rounded-full transition-all duration-300 ease-out relative",style:{width:`${Ie}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})})]}),e.jsxs("div",{className:"bg-[#0d1117] rounded-xl overflow-hidden border border-white/10 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 bg-[#161b22] border-b border-white/5",children:[e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/80"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/80"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/80"})]}),e.jsx("span",{className:"text-[10px] font-mono text-white/40 ml-2",children:"orion-audit --stream --mode=deep"})]}),e.jsxs("div",{className:"p-4 font-mono text-xs max-h-72 overflow-y-auto scroll-smooth",children:[Y.map((s,a)=>e.jsxs("div",{className:g("py-1 flex items-start gap-2",s.type==="connected"&&"text-green-400",s.type==="complete"&&"text-green-400 font-bold",s.type==="error"&&"text-red-500 font-bold"),children:[s.type==="connected"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-500",children:"➜"}),e.jsx("span",{className:"text-green-400",children:s.data.message})]}),s.type==="violation"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-white/30 w-14 shrink-0",children:["[",s.data.index,"/",s.data.total,"]"]}),e.jsx("span",{className:g("w-16 shrink-0 font-bold",s.data.severity==="HIGH"&&"text-red-400",s.data.severity==="MEDIUM"&&"text-amber-400",s.data.severity==="LOW"&&"text-blue-400"),children:s.data.severity}),e.jsx("span",{className:"text-cyan-400 shrink-0",children:s.data.file.split("/").pop()}),e.jsx("span",{className:"text-white/40",children:"→"}),e.jsx("span",{className:"text-white/60 truncate",children:s.data.violation})]}),s.type==="complete"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-500",children:"✓"}),e.jsxs("span",{children:["Scan completo! Health Score:"," ",e.jsx("span",{className:"text-primary font-black",children:s.data.healthScore}),"/100 | ",s.data.violationsCount," violações"]})]}),s.type==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-red-500",children:"✗"}),e.jsxs("span",{children:["Erro: ",s.data.message]})]})]},a)),C&&e.jsx("div",{className:"py-1 text-green-400 animate-pulse",children:"▌"})]})]})]}),e.jsx(F,{className:"p-0 bg-black/5",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(v,{className:"hover:bg-transparent border-amber-500/10 bg-amber-500/5",children:[e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest pl-6 text-amber-500/70 cursor-pointer hover:text-amber-500 transition-colors",onClick:()=>L("status"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Auditor"," ",e.jsx(y,{config:f,columnKey:"status"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest text-amber-500/70 cursor-pointer hover:text-amber-500 transition-colors",onClick:()=>L("lastDetectedAt"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Data"," ",e.jsx(y,{config:f,columnKey:"lastDetectedAt"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest text-amber-500/70 cursor-pointer hover:text-amber-500 transition-colors",onClick:()=>L("severity"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Severidade"," ",e.jsx(y,{config:f,columnKey:"severity"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest text-amber-500/70 cursor-pointer hover:text-amber-500 transition-colors",onClick:()=>L("file"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Arquivos / Componente"," ",e.jsx(y,{config:f,columnKey:"file"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest text-amber-500/70 cursor-pointer hover:text-amber-500 transition-colors",onClick:()=>L("violation"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Violação Sugerida"," ",e.jsx(y,{config:f,columnKey:"violation"})]})}),e.jsx(b,{className:"font-bold text-[10px] uppercase tracking-widest pr-6 text-amber-500/70",children:"Opção de Melhoria"})]})}),e.jsx(ge,{children:He.length===0?e.jsx(v,{children:e.jsx(h,{colSpan:5,className:"text-center py-24 text-amber-500/20 italic font-medium border-dashed border-amber-500/10",children:_?"Executando scan estrutural...":"Nenhum problema encontrado ou filtro sem resultados."})}):He.map((s,a)=>e.jsxs(v,{className:"hover:bg-amber-500/5 border-amber-500/10 transition-colors group cursor-pointer",onClick:()=>ke(s),children:[e.jsx(h,{className:"pl-6 py-5",children:e.jsx("div",{className:g("p-2 rounded-lg shrink-0",s.status==="FAIL"?"bg-red-500/10 text-red-500":"bg-amber-500/10 text-amber-500"),children:s.status==="FAIL"?e.jsx(We,{className:"w-5 h-5"}):e.jsx(Ts,{className:"w-5 h-5"})})}),e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-xs text-foreground",children:O(s.lastDetectedAt,"dd/MM/yy",{locale:J})}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:O(s.lastDetectedAt,"HH:mm")})]})}),e.jsx(h,{children:e.jsx(u,{className:g("rounded-lg border-0 font-black text-[10px] uppercase tracking-tight shadow-md",Fe(s.severity)),children:s.severity||"LOW"})}),e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-xs font-bold text-foreground truncate max-w-[200px]",title:s.file,children:s.file}),s.count>1&&e.jsxs("span",{className:"text-[9px] text-muted-foreground truncate w-[200px]",children:["+ ",s.count-1," outros arquivos"]})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-amber-500/90",children:s.violation}),e.jsx("span",{className:"text-[11px] text-muted-foreground leading-tight line-clamp-1 italic max-w-[250px]",title:s.message,children:s.message})]})}),e.jsx(h,{className:"pr-6",children:e.jsxs("div",{className:"flex items-center gap-2 bg-cyan-500/5 border border-cyan-500/10 p-3 rounded-xl",children:[e.jsx(D,{className:"w-3.5 h-3.5 text-cyan-400 fill-cyan-400 shrink-0"}),e.jsx("p",{className:"text-[11px] font-bold text-cyan-100/90 leading-relaxed truncate max-w-[350px]",title:s.suggestion,children:s.suggestion})]})})]},a))})]})})})]}),e.jsx(ce,{open:!!i,onOpenChange:s=>!s&&ke(null),children:e.jsxs(ne,{className:"max-w-4xl glass-card border-amber-500/20 bg-background/95 backdrop-blur-xl",children:[e.jsx(oe,{children:e.jsxs("div",{className:"flex items-center gap-5 mb-2",children:[e.jsx("div",{className:g("p-5 rounded-[24px] shadow-2xl shadow-amber-500/20",(i==null?void 0:i.status)==="FAIL"?"bg-red-500/20 text-red-500 border border-red-500/30":"bg-amber-500/20 text-amber-500 border border-amber-500/30"),children:e.jsx(ie,{className:"w-10 h-10"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(de,{className:"text-3xl font-black uppercase tracking-tighter text-amber-500 leading-none",children:"Detalhes da Violação Estrutural"}),e.jsxs(u,{className:g("rounded-xl border-0 font-black px-4 py-2 text-xs shadow-xl",Fe(i==null?void 0:i.severity)),children:["SEVERIDADE: ",i==null?void 0:i.severity]})]}),i!=null&&i.files&&((Re=i==null?void 0:i.files)==null?void 0:Re.length)>1?e.jsxs("div",{className:"mt-4 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-mono text-xs font-bold text-muted-foreground uppercase tracking-widest flex items-center gap-2",children:[e.jsx(E,{className:"w-3 h-3"})," ",i==null?void 0:i.count," ARQUIVOS AFETADOS"]}),e.jsxs(w,{variant:"outline",size:"sm",className:"h-6 text-[10px] gap-2 hover:bg-white/10 border-white/10 bg-black/20",onClick:()=>{i!=null&&i.files&&(navigator.clipboard.writeText(i==null?void 0:i.files.join(`
`)),N.success("Lista de arquivos copiada para a área de transferência!"))},children:[e.jsx(Es,{className:"w-3 h-3"})," COPIAR LISTA"]})]}),e.jsx("div",{className:"bg-black/40 rounded-xl border border-white/5 overflow-hidden shadow-inner",children:e.jsx("div",{className:"max-h-[140px] overflow-y-auto p-2 space-y-1",children:(_e=i==null?void 0:i.files)==null?void 0:_e.map((s,a)=>e.jsx("div",{className:"text-[10px] font-mono text-cyan-100/70 break-all py-1.5 border-b border-white/5 last:border-0 hover:bg-white/5 px-2 rounded transition-colors select-all",children:s},a))})})]}):e.jsxs(xe,{className:"font-mono text-xs font-bold text-muted-foreground mt-2 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(E,{className:"w-3 h-3"})," ARQUIVO:"," ",i==null?void 0:i.file]})]})]})}),i&&e.jsxs("div",{className:"space-y-8 pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_2fr] gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-6 rounded-[24px] bg-black/40 border border-white/5 space-y-2",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-amber-500 tracking-widest",children:"Tipo de Violação"}),e.jsx("p",{className:"text-sm font-black text-foreground uppercase",children:i.violation||"Desconhecida"})]}),e.jsxs("div",{className:"p-6 rounded-[24px] bg-black/40 border border-white/5 space-y-2",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-amber-500 tracking-widest",children:"Estado de Scan"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-green-500"}),e.jsx("p",{className:"text-sm font-black text-green-500 uppercase",children:"Monitoramento Ativo"})]})]})]}),e.jsxs("div",{className:"p-8 rounded-[32px] bg-black/60 border-2 border-amber-500/10 shadow-inner space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"w-5 h-5 text-amber-500"}),e.jsx("span",{className:"text-xs font-black text-amber-500 uppercase tracking-widest",children:"Descrição do Problema"})]}),e.jsx("p",{className:"text-lg font-bold text-foreground leading-relaxed",children:i.message})]})]}),e.jsxs("div",{className:"p-10 rounded-[40px] bg-cyan-500/5 border-2 border-cyan-500/20 shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10",children:e.jsx(D,{className:"w-32 h-32 text-cyan-400 rotate-12"})}),e.jsxs("div",{className:"flex items-start gap-6 relative z-10",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-cyan-500/20 border border-cyan-500/30 text-cyan-400",children:e.jsx(D,{className:"w-10 h-10 fill-cyan-400"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"text-xs font-black text-cyan-400 uppercase tracking-[0.2em]",children:"Plano de Refatoração Recomendado"}),e.jsx("p",{className:"text-xl font-mono text-cyan-50 font-bold leading-relaxed",children:i.suggestion})]})]})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("p",{className:"text-[10px] text-muted-foreground font-black uppercase tracking-widest opacity-30",children:["ORION ARCHITECTURAL AUDITOR V2.4 //"," ",S(new Date,"yyyy")]})})]})]})})]}),e.jsx(q,{value:"checklist",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(k,{className:"glass-card border-white/5 overflow-hidden border-linear-to-b from-primary/20 to-transparent",children:[e.jsxs(H,{className:"bg-primary/5 border-b border-white/5 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-3 text-xl font-black uppercase tracking-tight",children:[e.jsx(M,{className:"w-6 h-6 text-primary"}),"Auditoria de Segurança"]}),e.jsx(u,{variant:"outline",className:"bg-primary/10 text-primary border-primary/20 font-black",children:"REPORT V3.0"})]}),e.jsx(B,{className:"text-muted-foreground mt-2 italic font-medium",children:"Checklist de conformidade técnica e LGPD - Gestão Virtual Online."})]}),e.jsx(F,{className:"p-0",children:e.jsx("div",{className:"divide-y divide-white/5",children:[{id:1,title:"Autenticação e Sessões",severity:"CRÍTICO",details:["Tokens expostos em tela/logs","Sessões sem expiração renovável"],suggestion:"Implementar httpOnly cookies e expiração curta via middleware."},{id:2,title:"Controle de Acesso (RBAC)",severity:"CRÍTICO",details:["Perfis com privilégios excessivos visíveis","Falta de MFA para cargos diretivos"],suggestion:"Implementar matriz RBAC estrita e 2FA para perfis 'GOD'."},{id:3,title:"Exposição de Dados (LGPD)",severity:"ALTO",details:["Nomes completos em dashboards públicos","Dados sensíveis sem anonimização"],suggestion:"Utilizar helper formatNameForLGPD() e aplicar máscaras em campos sensíveis."},{id:4,title:"Validação de Dados",severity:"MÉDIO",details:["Campos com 'Invalid Date' (RangeError)","Falta de sanitização em inputs de texto"],suggestion:"Corrigir funções de manipulação de datas e integrar Zod no backend."},{id:5,title:"Dashboard e Métricas",severity:"BAIXO",details:["Relatórios acessíveis sem filtro de perfil"],suggestion:"Implementar filtros de acesso por ID de Empresa/Canteiro no signal."}].map(s=>e.jsxs("div",{className:"p-6 space-y-4 hover:bg-white/2 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-xl bg-primary/10 flex items-center justify-center text-primary font-black text-xs",children:["0",s.id]}),e.jsx("h3",{className:"font-bold text-lg tracking-tight group-hover:text-primary transition-colors",children:s.title})]}),e.jsx(u,{className:`${s.severity==="CRÍTICO"?"bg-red-500/20 text-red-400 border-red-500/30":s.severity==="ALTO"?"bg-orange-500/20 text-orange-400 border-orange-500/30":"bg-blue-500/20 text-blue-400 border-blue-500/30"} font-black text-[10px] tracking-widest`,children:s.severity})]}),e.jsxs("div",{className:"pl-11 space-y-3",children:[e.jsx("div",{className:"space-y-1.5",children:s.details.map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(We,{className:"w-3.5 h-3.5 text-red-500/50"}),a]},t))}),e.jsxs("div",{className:"p-4 rounded-2xl bg-primary/5 border border-primary/10 text-primary-foreground text-xs font-bold flex items-start gap-3",children:[e.jsx(D,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsxs("p",{className:"leading-relaxed",children:[e.jsx("span",{className:"text-primary mr-2 uppercase tracking-widest text-[9px]",children:"Correção sugerida:"})," ",s.suggestion]})]})]})]},s.id))})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(k,{className:"glass-card border-white/5 bg-linear-to-br from-primary/5 to-transparent relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 pointer-events-none",children:e.jsx(M,{className:"w-40 h-40 text-primary"})}),e.jsx(H,{children:e.jsxs(V,{className:"text-xl font-black uppercase tracking-tighter flex items-center gap-2",children:[e.jsx(I,{className:"w-6 h-6 text-primary"}),"Métricas de Resiliência"]})}),e.jsxs(F,{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-6 rounded-[24px] bg-black/40 border border-white/5 group hover:border-primary/30 transition-all",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-muted-foreground tracking-[0.2em]",children:"Score de Segurança"}),e.jsxs("p",{className:"text-4xl font-black mt-2 text-primary tracking-tighter",children:["84",e.jsx("span",{className:"text-sm opacity-50 ml-1",children:"/100"})]})]}),e.jsxs("div",{className:"p-6 rounded-[24px] bg-black/40 border border-white/5 group hover:border-amber-500/30 transition-all",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-muted-foreground tracking-[0.2em]",children:"Status Geral"}),e.jsx("p",{className:"text-2xl font-black mt-2 text-amber-500 uppercase italic",children:"EM ALERTA"})]})]}),e.jsxs("div",{className:"space-y-5 pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold",children:"Criptografia em Repouso"}),e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase",children:"AES-256 GCM"})]}),e.jsx(u,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:"ATIVO"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold",children:"Monitoramento de Invasão"}),e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase",children:"SSE Master Runner"})]}),e.jsx(u,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:"ESTÁVEL"})]}),e.jsxs("div",{className:"flex items-center justify-between opacity-50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold",children:"MFA Administrativo"}),e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase",children:"TOTP / SMS"})]}),e.jsx(u,{variant:"outline",className:"border-white/10 text-muted-foreground",children:"DESATIVADO"})]})]}),e.jsx(w,{className:"w-full py-6 rounded-2xl bg-primary hover:bg-primary/90 text-white font-black uppercase tracking-widest shadow-xl shadow-primary/20 transition-all",children:"GERAR RELATÓRIO PDF"})]})]}),e.jsxs("div",{className:"p-8 rounded-[40px] bg-black/40 border border-white/5 flex items-center gap-6 group",children:[e.jsx("div",{className:"w-16 h-16 rounded-3xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-glow",children:e.jsx(M,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-lg uppercase tracking-tight",children:"Compromisso com a LGPD"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Todos os acessos à Central de Segurança são registrados e vinculados ao CPF do operador para fins de auditoria forense."})]})]})]})]})})]}),e.jsx(ce,{open:!!n,onOpenChange:s=>!s&&Ne(null),children:e.jsxs(ne,{className:"max-w-3xl glass-card border-primary/20 bg-background/95 backdrop-blur-xl",children:[e.jsx(oe,{children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:g("p-3 rounded-2xl shadow-glow",le((n==null?void 0:n.action)||"")),children:e.jsx(E,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsxs(de,{className:"text-2xl font-black uppercase tracking-tight flex items-center gap-2",children:[(n==null?void 0:n.action)==="UPDATE"?"Alteração de Dados":"Detalhes do Evento",n&&e.jsx(u,{className:le(n.action),children:n.action})]}),e.jsxs(xe,{className:"font-medium",children:["UUID do Registro:"," ",e.jsx("span",{className:"font-mono text-[10px] bg-black/20 p-1 rounded",children:n==null?void 0:n.record_id})]})]})]})}),n&&e.jsxs("div",{className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase text-muted-foreground flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"})," Data e Hora"]}),e.jsx("p",{className:"text-sm font-bold",children:O(n.performed_at,"dd/MM/yy 'às' HH:mm",{locale:J})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase text-muted-foreground flex items-center gap-1",children:[e.jsx(Je,{className:"w-3 h-3"})," Autor da Ação"]}),e.jsx("p",{className:"text-sm font-bold text-primary",children:n.performer_name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase text-muted-foreground flex items-center gap-1",children:[e.jsx(Je,{className:"w-3 h-3"})," Alvo / Afetado"]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-sm font-bold",children:((Ge=n.new_data)==null?void 0:Ge.name)||(($e=n.old_data)==null?void 0:$e.name)||((Ke=n.new_data)==null?void 0:Ke.email)||((ze=n.old_data)==null?void 0:ze.email)||"Registro ID"}),e.jsx("span",{className:"text-[9px] font-mono text-muted-foreground truncate max-w-[120px]",title:n.record_id,children:n.record_id})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase text-muted-foreground flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"})," Tabela"]}),e.jsx("p",{className:"text-sm font-bold",children:ds(n.table_name)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase text-muted-foreground flex items-center gap-1",children:[e.jsx(I,{className:"w-3 h-3"})," IP de Origem"]}),e.jsx("p",{className:"text-sm font-mono font-bold text-muted-foreground",children:n.ipAddress||"Não registrado"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase text-muted-foreground flex items-center gap-1",children:[e.jsx(W,{className:"w-3 h-3"})," Sistema"]}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-tight italic line-clamp-2",title:n.userAgent,children:n.userAgent||"Desconhecido"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Comparativo de Dados"}),e.jsx("div",{className:"p-1 rounded-xl bg-black/20 border border-white/5",children:e.jsx(xs,{oldData:n.old_data,newData:n.new_data})})]})]})]})})]})}export{Zs as default};
