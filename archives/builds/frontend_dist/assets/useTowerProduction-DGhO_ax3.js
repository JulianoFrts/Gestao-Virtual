import{r as e,t as b}from"./index-D951x4H-.js";function F(){const[E,u]=e.useState({}),[L,d]=e.useState(!1),[P,l]=e.useState(!1),g=e.useCallback(async(y,o,n,m)=>{if(!(!o||!m||y.length===0)){d(!0);try{const t=new URLSearchParams;o&&o!=="all"&&t.append("projectId",o),n&&n!=="all"&&t.append("siteId",n),t.append("companyId",m);const s=await b.get(`/production/tower-status?${t.toString()}`);if(s.error)throw console.error("[useTowerProduction] API Error:",s.error),new Error(s.error.message);const T=s.data||[],i={};return y.forEach(a=>{const c=a.productionActivityId||a.id,C=T.filter(A=>(A.activityStatuses||[]).some(r=>{var h,S,v;const B=r.activityId===c||((h=r.activity)==null?void 0:h.id)===c||((S=r.activity)==null?void 0:S.productionActivityId)===c,w=(((v=r.activity)==null?void 0:v.name)||"").trim().toLowerCase(),f=(a.name||"").trim().toLowerCase(),N=f&&w&&w.includes(f),p=r.status||"",D=p==="FINISHED"||p==="COMPLETED"||(r.progressPercent||0)>=100;return(B||N)&&D}));i[a.id]=C}),u(i),l(!0),i}catch(t){throw console.error("[useTowerProduction] Erro ao carregar dados:",t),t}finally{d(!1)}}},[]),I=e.useCallback(()=>{u({}),l(!1)},[]);return{towersByStage:E,isLoading:L,hasLoaded:P,loadProductionData:g,reset:I}}export{F as u};
