import{f as d,V as l,W as p,X as i}from"./index-D951x4H-.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],g=d("FileDown",v),o=l({}),f=l(!1),m=(e,t)=>{const s={...o.value};!s[e]&&!t.type||(s[e]={...s[e]||{},...t,id:e},o.value=s,f.value=Object.values(s).some(a=>a.status==="processing"||a.status==="pending"))},u=e=>{const t={...o.value};delete t[e],o.value=t,f.value=Object.values(t).some(s=>s.status==="processing"||s.status==="pending")},b=async e=>{const t=async()=>{var n;try{const{data:r,error:c}=await p.from("jobs").select("*").eq("id",e).single();if(c)return console.error("[Signals] Error fetching job status:",c),!1;if(!r)return!1;if(m(e,r),r.status==="completed"){const h=(n=r.payload)==null?void 0:n.results;return i({title:"Processamento concluÃ­do",description:`Tarefa ${r.type} finalizada com sucesso.`}),setTimeout(()=>u(e),5e3),!0}return r.status==="failed"?(i({title:"Falha no processamento",description:r.error||"Ocorreu um erro na tarefa.",variant:"destructive"}),setTimeout(()=>u(e),1e4),!0):!1}catch(r){return console.error("Job monitoring error:",r),!1}};if(await t())return;const a=setInterval(async()=>{await t()&&clearInterval(a)},3e3)};export{g as F,b as m,m as u};
