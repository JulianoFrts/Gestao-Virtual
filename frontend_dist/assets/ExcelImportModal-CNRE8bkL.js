import{j as e,p as l,s as D,S as de,G as me,H as xe,I as pe,J as H,q as Q,L as V,$ as U,v as he,B as k,K as ue,Y as z,Z as B,_ as $,aA as M,ac as be,u as sa,r as h,b as ta,a$ as A,t as L,D as je,k as fe,l as Ne,m as ve,a4 as qe,o as we,F as ra,aS as ye,bJ as oa,e as na}from"./index-D951x4H-.js";import{T as ia,a as la,b as He,c as Ge}from"./tabs-D3Kawp4S.js";import{T as ca}from"./textarea-Db2vMs5u.js";import{C as ae}from"./calendar-MfduwZdl.js";import{C as da,a as ma,b as xa,c as pa,d as ha,e as Ve}from"./command-DzEVDCzR.js";import{u as le,a as se}from"./CartesianGrid-HrqNXgEf.js";import{T as ua}from"./triangle-alert-BPKdZxxI.js";import{f as J}from"./format-CP1OFCPJ.js";import{C as ge}from"./calendar-B3GVMfO3.js";import{C as ga}from"./chevrons-up-down-BNQt7ayD.js";import{I}from"./input-dNnkIPn6.js";import{u as ee,w as ba,r as ja}from"./xlsx-BBWTpfDg.js";import{U as ce}from"./upload-D2Q7C-3S.js";import{I as fa}from"./info-MbzHf59N.js";import{D as Na}from"./download-L1tB_Hhn.js";const va=({status:g,setStatus:b,landStatus:n,setLandStatus:t,selectedReasonId:y,setSelectedReasonId:u,setImpedimentType:N,delayReasons:a,progressPercent:j,setProgressPercent:S,isFoundation:c,componentLabels:x,components:w,toggleComponentStatus:E})=>e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsxs(l,{htmlFor:"status",className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 flex items-center gap-2 px-1",children:[e.jsx("div",{className:"w-1 h-3 bg-amber-500 rounded-full"})," Status Atividade"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 p-1 bg-black/40 rounded-2xl border border-white/5",children:[{id:"PENDING",label:"Pendente",color:"bg-[#5D4037]/40 text-orange-200 border-[#5D4037]"},{id:"IN_PROGRESS",label:"Execução",color:"bg-amber-500/20 text-amber-500 border-amber-500/30"},{id:"FINISHED",label:"Concluído",color:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"}].map(i=>e.jsxs("button",{onClick:()=>b(i.id),className:D("flex flex-col items-center justify-center py-3 px-2 rounded-xl border transition-all duration-300 group relative overflow-hidden",g===i.id?i.color+" shadow-lg shadow-black/40 scale-100":"bg-transparent border-transparent text-slate-500 hover:bg-white/5 opacity-60 hover:opacity-100 scale-95"),children:[g===i.id&&e.jsx("div",{className:"absolute top-0 right-0 p-1",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-current rounded-full animate-pulse"})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest italic",children:i.label})]},i.id))})]}),e.jsxs("div",{className:D("grid gap-4 transition-all duration-500",n==="EMBARGO"?"grid-cols-1":"grid-cols-2"),children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(l,{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1 opacity-70",children:"Status Fundiário"}),e.jsxs(de,{value:n,onValueChange:i=>t(i),children:[e.jsx(me,{className:D("h-11 border-white/5 bg-white/3 text-xs font-black rounded-xl transition-all",n==="EMBARGO"&&"bg-red-500/20 text-red-400 border-red-500/30 shadow-[0_0_20px_rgba(239,68,68,0.1)]",n==="IMPEDIMENT"&&"bg-orange-500/20 text-orange-400 border-orange-500/30",n==="FREE"&&"bg-white/3 text-emerald-500"),children:e.jsx(xe,{})}),e.jsxs(pe,{className:"bg-slate-900 border-white/10 text-slate-100 rounded-2xl",children:[e.jsx(H,{value:"FREE",className:"font-bold",children:"✓ Liberado"}),e.jsx(H,{value:"IMPEDIMENT",className:"font-bold text-orange-400",children:"⚠ Impedimento"}),e.jsx(H,{value:"EMBARGO",className:"font-bold text-red-400",children:"✖ Embargo"})]})]})]}),n!=="EMBARGO"&&e.jsxs("div",{className:"grid gap-3 animate-in slide-in-from-right-2 duration-300",children:[e.jsx(l,{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1 opacity-70",children:"Motivo / Detalhe"}),e.jsxs(de,{value:y,onValueChange:i=>{u(i);const o=a.find(d=>d.id===i);o&&N(o.category)},children:[e.jsx(me,{className:"h-11 bg-white/3 border-white/5 text-xs font-bold rounded-xl italic",children:e.jsx(xe,{placeholder:"Opcional..."})}),e.jsx(pe,{className:"bg-slate-900 border-white/10 text-slate-100 rounded-2xl max-h-[300px]",children:a.map(i=>e.jsx(H,{value:i.id,className:"text-[10px] font-black p-3 hover:bg-white/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{variant:"outline",className:"bg-amber-500/10 text-amber-500 border-amber-500/20 font-mono text-[9px] shrink-0",children:i.code}),e.jsx("span",{className:"uppercase tracking-tight leading-tight",children:i.description})]})},i.id))})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 bg-linear-to-r from-amber-500/10 to-transparent p-5 rounded-2xl border border-amber-500/10 ring-1 ring-white/5",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-[10px] font-black uppercase tracking-[0.2em] text-amber-500/80",children:"Avanço Físico"}),e.jsx("p",{className:"text-[8px] text-slate-500 font-bold uppercase tracking-widest italic opacity-50",children:"Arraste para atualizar o percentual"})]}),e.jsxs("div",{className:"text-3xl font-black italic tracking-tighter text-amber-500 drop-shadow-glow",children:[j,e.jsx("span",{className:"text-xs ml-1 opacity-50",children:"%"})]})]}),e.jsxs("div",{className:"relative pt-2 pb-1",children:[e.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:j,onChange:i=>S(parseInt(i.target.value)),className:"w-full h-2 bg-black/60 rounded-full appearance-none cursor-pointer accent-amber-500 transition-all hover:bg-black/80",disabled:g==="FINISHED"}),e.jsx("div",{className:"absolute h-2 bg-amber-500 rounded-full pointer-events-none transition-all duration-300 shadow-[0_0_15px_rgba(245,158,11,0.4)]",style:{width:`${j}%`,top:"12px"}})]}),e.jsxs("div",{className:"flex justify-between px-1",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-600 uppercase",children:"0%"}),e.jsx("span",{className:"text-[8px] font-black text-slate-600 uppercase",children:"100%"})]})]}),c&&e.jsxs("div",{className:"grid gap-4 bg-white/2 p-5 rounded-3xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-500/10 flex items-center justify-center border border-emerald-500/20",children:e.jsx("span",{className:"text-emerald-500 text-[10px] font-black",children:"4x"})}),e.jsx(l,{className:"text-[10px] uppercase font-black text-slate-400 tracking-[0.2em]",children:"Componentes da Estrutura"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mt-1",children:x.map(i=>{const o=w[i];return e.jsxs("div",{className:D("group flex items-center justify-between p-4 rounded-2xl cursor-pointer transition-all duration-500 border relative overflow-hidden",o==="FINISHED"&&"bg-emerald-500/10 border-emerald-500/30 shadow-[0_10px_30px_rgba(16,185,129,0.1)]",o==="IN_PROGRESS"&&"bg-amber-500/5 border-amber-500/20",o==="PENDING"&&"bg-black/20 border-white/5 hover:border-white/10 hover:bg-white/5"),onClick:()=>E(i),children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:D("text-[10px] font-black uppercase tracking-widest italic group-hover:scale-105 transition-transform origin-left",o==="FINISHED"&&"text-emerald-400",o==="IN_PROGRESS"&&"text-amber-200",o==="PENDING"&&"text-slate-600 group-hover:text-slate-400"),children:i}),e.jsx("span",{className:"text-[7px] font-black text-white/10 uppercase tracking-[0.3em] group-hover:text-white/20 transition-colors",children:"ESTRUTURA"})]}),e.jsx(Q,{className:D("text-[8px] font-black tracking-widest border-none px-2 h-5 rounded-lg shadow-sm group-hover:rotate-12 transition-transform",o==="FINISHED"&&"bg-emerald-500 text-black",o==="IN_PROGRESS"&&"bg-amber-500 text-black",o==="PENDING"&&"bg-white/5 text-slate-700"),children:o==="FINISHED"?"OK":o==="IN_PROGRESS"?"EXE":"PEN"})]},i)})}),e.jsx("p",{className:"text-[8px] text-center text-slate-600 font-black uppercase tracking-widest opacity-50 mt-2",children:"O avanço físico é calculado proporcionalmente aos componentes"})]})]}),wa=({isLoadingHistory:g,history:b,approveMutation:n})=>g?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 gap-4 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"w-8 h-8 text-amber-500 animate-spin"}),e.jsx("div",{className:"absolute inset-0 bg-amber-500/20 blur-xl rounded-full"})]}),e.jsx("span",{className:"text-[10px] text-slate-500 font-black uppercase tracking-[0.3em]",children:"Sincronizando Histórico..."})]}):b.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 gap-4 text-slate-700 animate-in zoom-in-95 duration-500",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-white/2 border border-white/5 flex items-center justify-center",children:e.jsx(ua,{className:"w-6 h-6 opacity-30"})}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Nenhum registro encontrado"}),e.jsx("p",{className:"text-[8px] font-bold text-slate-600 uppercase tracking-widest",children:"Inicie a execução para gerar logs"})]})]}):e.jsx("div",{className:"px-8 py-6 max-h-[65vh] overflow-y-auto custom-scrollbar animate-in fade-in slide-in-from-right-4 duration-500",children:e.jsx("div",{className:"space-y-6 relative before:absolute before:left-[11px] before:top-2 before:bottom-2 before:w-px before:bg-linear-to-b before:from-amber-500/50 before:via-white/5 before:to-white/5",children:b.map((t,y)=>{var u;return e.jsxs("div",{className:"relative pl-10 group",children:[e.jsx("div",{className:D("absolute left-0 top-1.5 w-6 h-6 rounded-full border-4 border-slate-950 flex items-center justify-center z-10 transition-all duration-500",t.status==="APPROVED"?"bg-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.3)]":"bg-amber-600"),children:t.status==="APPROVED"?e.jsx(U,{className:"w-2.5 h-2.5 text-black"}):e.jsx("div",{className:"w-1 h-1 bg-white rounded-full animate-pulse"})}),e.jsxs("div",{className:"bg-white/2 rounded-2xl p-5 border border-white/5 group-hover:bg-white/5 group-hover:border-white/10 transition-all duration-500 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-linear-to-r from-transparent via-white/10 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[10px] font-black text-amber-500/60 font-mono tracking-tighter uppercase",children:J(new Date(t.timestamp),"dd/MM/yyyy • HH:mm")}),e.jsx(Q,{className:D("text-[9px] font-black h-4 px-2 uppercase tracking-widest border-none rounded-full",t.status==="FINISHED"&&"bg-emerald-500 text-black",t.status==="IN_PROGRESS"&&"bg-amber-500 text-black",t.status==="PENDING"&&"bg-slate-800 text-slate-400",t.status==="APPROVED"&&"bg-sky-500 text-black"),children:t.status==="IN_PROGRESS"?"EXECUÇÃO":t.status})]}),e.jsxs("div",{className:"flex items-end gap-1",children:[e.jsx("span",{className:"text-2xl font-black italic tracking-tighter text-white",children:t.progress}),e.jsx("span",{className:"text-[10px] font-black text-white/30 mb-2",children:"% AVANÇO"})]})]}),t.status!=="APPROVED"&&he("production.canApproveLogs")&&e.jsxs(k,{size:"sm",variant:"outline",className:"h-10 px-4 text-[9px] font-black uppercase tracking-widest border-emerald-500/20 text-emerald-400 bg-emerald-500/5 hover:bg-emerald-500 hover:text-black rounded-xl transition-all shadow-lg active:scale-95",onClick:()=>n.mutate({progressId:t.progressId,logTimestamp:t.timestamp}),disabled:n.isPending,children:[n.isPending?e.jsx(V,{className:"w-3 h-3 animate-spin"}):e.jsx(U,{className:"w-3 h-3 mr-2"}),"APROVAR REGISTRO"]}),t.status==="APPROVED"&&e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-[9px] font-black text-emerald-500 uppercase tracking-widest",children:[e.jsx(U,{className:"w-3.5 h-3.5"}),"VALIDADO"]}),e.jsx("span",{className:"text-[8px] font-bold text-slate-500 uppercase tracking-wider italic",children:t.approvedBy||"SISTEMA"})]})]}),t.notes&&e.jsx("div",{className:"relative group/note p-4 bg-black/40 rounded-xl border-l-2 border-amber-500/40",children:e.jsxs("p",{className:"text-[11px] text-slate-300 font-bold leading-relaxed italic",children:['"',t.notes,'"']})}),e.jsxs("div",{className:"flex items-center justify-between mt-5 pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-white/5 flex items-center justify-center border border-white/5",children:e.jsx(ue,{className:"w-3 h-3 text-slate-400"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:((u=t.metadata)==null?void 0:u.leadName)||"SISTEMA"}),e.jsx("span",{className:"text-[7px] font-bold text-slate-600 uppercase tracking-[0.2em]",children:"RESPONSÁVEL CAMPO"})]})]}),e.jsx("div",{className:"text-[7px] font-black text-white/5 uppercase tracking-[0.4em]",children:"ORION CORE LAYER"})]})]})]},y)})})}),ya=({plannedStart:g,setPlannedStart:b,plannedEnd:n,setPlannedEnd:t,plannedQuantity:y,setPlannedQuantity:u,plannedHours:N,setPlannedHours:a})=>e.jsxs("div",{className:"border border-indigo-500/20 bg-indigo-950/20 p-3 rounded-xl space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-3 w-3 text-indigo-400"}),e.jsx(l,{className:"text-[10px] font-bold uppercase text-indigo-400 tracking-wider",children:"Dados de Planejamento"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx(l,{className:"text-[9px] font-medium text-slate-400 uppercase",children:"Início"}),e.jsxs(z,{children:[e.jsx(B,{asChild:!0,children:e.jsx(k,{variant:"outline",className:"h-8 bg-slate-900 border-indigo-500/30 text-[10px] hover:bg-indigo-950/40 font-bold",children:g?J(g,"dd/MM/yyyy"):"Definir"})}),e.jsx($,{className:"w-auto p-0 bg-slate-900 border-slate-800",children:e.jsx(ae,{mode:"single",selected:g,onSelect:b,className:"bg-slate-900 text-slate-100"})})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(l,{className:"text-[9px] font-medium text-slate-400 uppercase",children:"Fim"}),e.jsxs(z,{children:[e.jsx(B,{asChild:!0,children:e.jsx(k,{variant:"outline",className:"h-8 bg-slate-900 border-indigo-500/30 text-[10px] hover:bg-indigo-950/40 font-bold",children:n?J(n,"dd/MM/yyyy"):"Definir"})}),e.jsx($,{className:"w-auto p-0 bg-slate-900 border-slate-800",children:e.jsx(ae,{mode:"single",selected:n,onSelect:t,className:"bg-slate-900 text-slate-100"})})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(l,{className:"text-[9px] font-medium text-slate-400 uppercase",children:"Qtd Plan"}),e.jsx("input",{type:"number",placeholder:"0.00",className:"h-8 bg-slate-900 border border-indigo-500/30 rounded-md px-2 text-[10px] text-white focus:outline-hidden focus:border-indigo-500 font-bold",value:y,onChange:j=>u(j.target.value)})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(l,{className:"text-[9px] font-medium text-slate-400 uppercase",children:"HHH Prev"}),e.jsx("input",{type:"number",placeholder:"0.00",className:"h-8 bg-slate-900 border border-indigo-500/30 rounded-md px-2 text-[10px] text-white focus:outline-hidden focus:border-indigo-500 font-bold",value:N,onChange:j=>a(j.target.value)})]})]})]}),Ha=M.memo(({isOpen:g,onClose:b,elementId:n,towerName:t,towerType:y,activityId:u,activityName:N,currentStatus:a,projectId:j})=>{var Oe,Me;const S=be(),{profile:c}=sa(),[x,w]=h.useState((a==null?void 0:a.status)||"PENDING"),[E,i]=h.useState((a==null?void 0:a.landStatus)||"FREE"),[o,d]=h.useState((a==null?void 0:a.impedimentType)||"NONE"),[m,_]=h.useState((a==null?void 0:a.progressPercent)||0),[s,R]=h.useState(a!=null&&a.startDate?new Date(a.startDate):void 0),[C,O]=h.useState(a!=null&&a.endDate?new Date(a.endDate):void 0),[P,X]=h.useState((a==null?void 0:a.notes)||""),[F,Ee]=h.useState(((Oe=a==null?void 0:a.metadata)==null?void 0:Oe.leadName)||""),[Ke,te]=h.useState(!1),[Ue,ke]=h.useState(!1),[ze,Pe]=h.useState(!1),[Se,Ce]=h.useState(),[Ie,Fe]=h.useState(),[re,Te]=h.useState(""),[oe,De]=h.useState(""),[Be,$e]=h.useState(""),{employees:Ae}=ta(),{data:Qe=[],isLoading:Je}=le({queryKey:["production-logs",n,u],queryFn:async()=>(await L.get(`/production/logs?elementId=${n}&activityId=${u}`)).data||[],enabled:g&&!!n&&!!u}),{data:T}=le({queryKey:["production-schedule",n,u],queryFn:async()=>{const r=await L.get(`/production/schedule?elementId=${n}`);return r.data&&Array.isArray(r.data)&&r.data.find(f=>f.activityId===u)||null},enabled:g&&!!n&&!!u}),{data:Xe=[]}=le({queryKey:["delay-reasons",n],queryFn:async()=>(await L.get(`/production/delay-reasons?projectId=${j}`)).data||[],enabled:g&&!!j&&j!=="all"});M.useEffect(()=>{T&&(T.plannedStart&&Ce(new Date(T.plannedStart)),T.plannedEnd&&Fe(new Date(T.plannedEnd)),T.plannedQuantity&&Te(T.plannedQuantity.toString()),T.plannedHours&&De(T.plannedHours.toString()))},[T]);const Ye=M.useMemo(()=>Ae.filter(r=>r.canLeadTeam||r.professionalLevel>=3),[Ae]),G=M.useMemo(()=>["fundação","escavação","armação","concretagem","reaterro"].some(r=>N.toLowerCase().includes(r)),[N]),_e=M.useMemo(()=>(y==null?void 0:y.toLowerCase().includes("estaiada"))?["Mastro","Estai A","Estai B","Estai C","Estai D"]:["Pé A","Pé B","Pé C","Pé D"],[y]),[q,Re]=h.useState(((Me=a==null?void 0:a.metadata)==null?void 0:Me.components)||Object.fromEntries(_e.map(r=>[r,"PENDING"]))),We=se({mutationFn:async({progressId:r,logTimestamp:f})=>L.post("/production/logs",{progressId:r,logTimestamp:String(f)}),onSuccess:()=>{S.invalidateQueries({queryKey:["production-logs",n,u]}),A.success("Log aprovado com sucesso")},onError:r=>{var p,v;const f=((v=(p=r.response)==null?void 0:p.data)==null?void 0:v.message)||r.message||"Erro desconhecido";A.error("Erro ao aprovar log: "+f)}}),Y=se({mutationFn:async()=>{const r=x;let f=m,p=s,v=C;if(r==="FINISHED"&&(f=100,p||(p=new Date),v||(v=new Date)),p&&v&&p>v)throw A.error("A data de início real não pode ser maior que a data de fim real."),new Error("Validation failed: StartDate > EndDate");if(r==="PENDING"&&P.length<10&&F==="none")throw A.error("Status 'Pendente' exige justificativa nas observações ou programação."),new Error("Validation failed");let K=!1,ie="";if(a&&(a.progressPercent&&f<a.progressPercent&&r!=="PENDING"&&(K=!0,ie=`Redução de avanço detectada (${a.progressPercent}% -> ${f}%).`),a.startDate&&!p&&(K=!0,ie+=" Remoção de data de início.")),K&&P.length<5)throw A.error("Detectada regressão de dados. É OBRIGATÓRIO informar uma justificativa."),new Error("Validation failed");const ea={elementId:n,activityId:u,status:r,landStatus:E,impedimentType:o,foremanName:F,progressPercent:f,startDate:p==null?void 0:p.toISOString(),endDate:v==null?void 0:v.toISOString(),notes:P,requiresApproval:K,approvalReason:K?ie:null,metadata:{components:G?q:void 0,leadName:F}};let W=Se,Z=Ie;if(!W&&p&&(W=p),!Z&&v&&(Z=v),W&&Z){const Le=aa=>new Date(aa.setHours(12,0,0,0)).toISOString();await L.post("/production/schedule",{towerId:n,activityId:u,plannedStart:Le(W),plannedEnd:Le(Z),plannedQuantity:re?parseFloat(re):null,plannedHHH:oe?parseFloat(oe):null})}return(await L.post("/production/tower-status",ea)).data},onSuccess:()=>{["production-towers","production-schedule","production-logs"].forEach(r=>S.invalidateQueries({queryKey:[r]})),A.success("Dados atualizados com sucesso"),b()}});M.useEffect(()=>{if(!G)return;const r=Object.keys(q).length;if(r===0)return;const f=Object.values(q).filter(v=>v==="FINISHED").length,p=Math.round(f/r*100);x!=="FINISHED"&&m!==p&&!ne.current&&_(p)},[q,G,x,m]);const ne=M.useRef(!1);M.useEffect(()=>{G&&(m===100||x==="FINISHED")&&Object.values(q).some(f=>f!=="FINISHED")&&(ne.current=!0,Re(f=>{const p={...f};return Object.keys(p).forEach(v=>{p[v]="FINISHED"}),p}),setTimeout(()=>{ne.current=!1},100))},[m,x,G,q]);const Ze=M.useCallback(r=>{Re(f=>{const p=f[r],v=p==="PENDING"?"IN_PROGRESS":p==="IN_PROGRESS"?"FINISHED":"PENDING";return{...f,[r]:v}})},[]);return e.jsx(je,{open:g,onOpenChange:b,children:e.jsxs(fe,{className:"sm:max-w-[480px] p-0 border-white/5 bg-slate-950/90 backdrop-blur-3xl text-slate-100 overflow-hidden rounded-4xl shadow-2xl",children:[e.jsx("div",{className:"absolute -top-24 -right-24 w-64 h-64 bg-amber-500/10 blur-[100px] rounded-full pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-24 -left-24 w-64 h-64 bg-amber-500/5 blur-[100px] rounded-full pointer-events-none"}),e.jsxs(ia,{defaultValue:"status",className:"w-full relative z-10",children:[e.jsxs("div",{className:"px-8 pt-8 pb-4 border-b border-white/5 space-y-5 bg-linear-to-b from-white/2 to-transparent",children:[e.jsxs(Ne,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ve,{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-2xl font-black italic tracking-tighter text-white uppercase leading-none",children:t}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",className:"text-[8px] font-black tracking-widest bg-amber-500/10 text-amber-500 border-amber-500/20 px-2 py-0.5 rounded-full uppercase",children:N}),e.jsxs("span",{className:"text-[10px] text-white/20 font-mono tracking-tighter",children:["ID: ",n==null?void 0:n.slice(-8).toUpperCase()]})]})]}),e.jsx(k,{variant:"ghost",size:"icon",onClick:b,className:"rounded-full hover:bg-white/10 text-slate-400",children:e.jsx(qe,{className:"w-4 h-4"})})]}),e.jsx(we,{className:"text-[10px] uppercase font-black tracking-widest text-slate-500 pt-2",children:"Gestão de Produção Unificada"})]}),e.jsxs(la,{className:"bg-black/40 border border-white/5 w-full h-11 p-1 rounded-xl",children:[e.jsx(He,{value:"status",className:"flex-1 text-[10px] uppercase font-black tracking-widest data-[state=active]:bg-amber-500/10 data-[state=active]:text-amber-500 rounded-lg transition-all",children:"Status & Avanço"}),e.jsx(He,{value:"history",className:"flex-1 text-[10px] uppercase font-black tracking-widest data-[state=active]:bg-amber-500/10 data-[state=active]:text-amber-500 rounded-lg transition-all",children:"Histórico de Logs"})]})]}),e.jsxs(Ge,{value:"status",className:"m-0 focus-visible:outline-hidden animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("div",{className:"px-8 py-6 max-h-[60vh] overflow-y-auto custom-scrollbar space-y-8",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsxs(l,{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 flex items-center gap-2",children:[e.jsx(ue,{className:"w-3 h-3 text-amber-500"})," Encarregado"]}),e.jsxs(z,{open:Ke,onOpenChange:te,children:[e.jsx(B,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:"h-12 w-full justify-between bg-white/3 border-white/5 text-slate-200 px-4 rounded-xl hover:bg-white/6 transition-all",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-bold text-xs truncate",children:F&&F!=="none"?F:"Selecionar responsável..."})}),e.jsx(ga,{className:"h-4 w-4 opacity-30"})]})}),e.jsx($,{className:"w-[300px] p-0 bg-slate-900 border-white/10 shadow-2xl rounded-2xl",align:"start",children:e.jsxs(da,{className:"bg-transparent text-slate-100",children:[e.jsx(ma,{placeholder:"Procurar líder...",className:"h-11 border-none focus:ring-0 text-sm"}),e.jsxs(xa,{className:"max-h-[300px] custom-scrollbar",children:[e.jsx(pa,{className:"py-8 text-center text-xs text-slate-500",children:"Ninguém encontrado."}),e.jsxs(ha,{heading:"Liderança de Campo",children:[e.jsxs(Ve,{value:"none",onSelect:()=>{Ee("none"),te(!1)},className:"flex items-center gap-2 p-3 cursor-pointer hover:bg-white/5 rounded-lg m-1",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(qe,{className:"w-3 h-3"})}),e.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Nenhum"}),e.jsx(U,{className:D("ml-auto h-4 w-4",F==="none"?"opacity-100":"opacity-0")})]}),Ye.map(r=>e.jsxs(Ve,{value:r.fullName,onSelect:()=>{Ee(r.fullName),te(!1)},className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-white/5 rounded-lg m-1 group",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-amber-500/10 flex items-center justify-center shrink-0",children:e.jsx(ue,{className:"w-3 h-3 text-amber-500"})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-xs font-black group-hover:text-amber-500 transition-colors truncate uppercase italic",children:r.fullName}),e.jsx("span",{className:"text-[9px] text-slate-500 uppercase font-black tracking-widest",children:r.functionName||"Encarregado"})]}),e.jsx(U,{className:D("ml-auto h-4 w-4 text-amber-500",F===r.fullName?"opacity-100":"opacity-0")})]},r.id))]})]})]})})]})]}),e.jsx(va,{status:x,setStatus:w,landStatus:E,setLandStatus:i,selectedReasonId:Be,setSelectedReasonId:$e,setImpedimentType:d,delayReasons:Xe,progressPercent:m,setProgressPercent:_,isFoundation:G,componentLabels:_e,components:q,toggleComponentStatus:Ze}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 border-t border-white/5 pt-6 bg-white/1 -mx-8 px-8 pb-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{className:"text-[9px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Início Real"}),e.jsxs(z,{open:Ue,onOpenChange:ke,children:[e.jsx(B,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:"h-11 bg-white/3 border-white/5 justify-start text-[11px] font-black tracking-tight rounded-xl hover:bg-white/10",children:[e.jsx(ge,{className:"mr-2 h-3.5 w-3.5 text-sky-500"}),s?J(s,"dd/MM/yyyy"):"DEFINIR DATA"]})}),e.jsx($,{className:"w-auto p-0 bg-slate-900 border-white/10 rounded-2xl shadow-2xl",children:e.jsx(ae,{mode:"single",selected:s,onSelect:r=>{R(r),ke(!1)},className:"bg-transparent text-slate-100"})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{className:"text-[9px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Fim Real"}),e.jsxs(z,{open:ze,onOpenChange:Pe,children:[e.jsx(B,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:"h-11 bg-white/3 border-white/5 justify-start text-[11px] font-black tracking-tight rounded-xl hover:bg-white/10",children:[e.jsx(ge,{className:"mr-2 h-3.5 w-3.5 text-sky-500"}),C?J(C,"dd/MM/yyyy"):"DEFINIR DATA"]})}),e.jsx($,{className:"w-auto p-0 bg-slate-900 border-white/10 rounded-2xl shadow-2xl",children:e.jsx(ae,{mode:"single",selected:C,onSelect:r=>{O(r),Pe(!1)},className:"bg-transparent text-slate-100"})})]})]})]}),he("showProjectManagement")&&e.jsx(ya,{plannedStart:Se,setPlannedStart:Ce,plannedEnd:Ie,setPlannedEnd:Fe,plannedQuantity:re,setPlannedQuantity:Te,plannedHours:oe,setPlannedHours:De}),e.jsxs("div",{className:"grid gap-3 pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsxs(l,{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 flex items-center gap-2",children:[e.jsx(ra,{className:"w-3 h-3 text-amber-500"})," Justificativa / Notas"]}),x==="PENDING"&&e.jsx(Q,{variant:"outline",className:"text-[8px] font-black uppercase tracking-widest text-amber-500 bg-amber-500/5 border-amber-500/20 px-2 h-4 rounded-full",children:"Obrigatória"})]}),e.jsx(ca,{placeholder:"Descreva detalhes de campo, dificuldades ou observações técnicas...",className:"bg-white/3 border-white/5 text-slate-200 text-xs min-h-[80px] rounded-xl focus:border-amber-500/30 transition-all placeholder:text-slate-700 p-4",value:P,onChange:r=>X(r.target.value)})]})]}),e.jsxs(ye,{className:"px-8 py-6 border-t border-white/5 bg-white/2 flex flex-row items-center justify-between gap-4",children:[e.jsx(k,{variant:"ghost",size:"sm",onClick:b,disabled:Y.isPending,className:"text-slate-500 hover:text-white hover:bg-white/5 font-black h-11 px-6 text-[10px] uppercase tracking-widest rounded-xl transition-all",children:"CANCEL"}),(he("production.canRegisterAdvance")||oa.value||(c==null?void 0:c.isSystemAdmin)||["SUPER_ADMIN_GOD","SUPERADMINGOD","SUPER_ADMIN","SUPERADMIN","ADMIN","TI_SOFTWARE","TISOFTWARE","HELPER_SYSTEM"].includes((c==null?void 0:c.role)||""))&&e.jsxs(k,{size:"sm",onClick:()=>Y.mutate(),disabled:Y.isPending,className:"bg-amber-600 hover:bg-amber-500 text-black font-black px-8 h-12 text-[10px] uppercase tracking-[0.2em] shadow-[0_10px_40px_rgba(217,119,6,0.2)] hover:shadow-[0_10px_40px_rgba(217,119,6,0.4)] transition-all hover:scale-[1.02] active:scale-95 rounded-xl border border-white/10",children:[Y.isPending&&e.jsx(V,{className:"mr-2 h-3 w-3 animate-spin"}),"Registrar Avanço"]})]})]}),e.jsx(Ge,{value:"history",className:"m-0 focus-visible:outline-hidden",children:e.jsx(wa,{isLoadingHistory:Je,history:Qe,approveMutation:We})})]})]})})}),Ga=({isOpen:g,onClose:b,projectId:n,tower:t})=>{const y=be(),[u,N]=h.useState(!1),[a,j]=h.useState({objectId:"",trecho:"",towerType:"Autoportante",tipoFundacao:"",totalConcreto:"",pesoArmacao:"",pesoEstrutura:"",tramoLancamento:"",tipificacaoEstrutura:"",goForward:"",technicalKm:"",objectSeq:""});h.useEffect(()=>{var x,w,E,i,o,d;j(t?{objectId:t.objectId||"",trecho:t.trecho||"",towerType:t.towerType||"Autoportante",tipoFundacao:t.tipoFundacao||"",totalConcreto:((x=t.totalConcreto)==null?void 0:x.toString())||"",pesoArmacao:((w=t.pesoArmacao)==null?void 0:w.toString())||"",pesoEstrutura:((E=t.pesoEstrutura)==null?void 0:E.toString())||"",tramoLancamento:t.tramoLancamento||"",tipificacaoEstrutura:t.tipificacaoEstrutura||"",goForward:((i=t.goForward)==null?void 0:i.toString())||"",technicalKm:((o=t.technicalKm)==null?void 0:o.toString())||"",objectSeq:((d=t.objectSeq)==null?void 0:d.toString())||""}:{objectId:"",trecho:"",towerType:"Autoportante",tipoFundacao:"",totalConcreto:"",pesoArmacao:"",pesoEstrutura:"",tramoLancamento:"",tipificacaoEstrutura:"",goForward:"",technicalKm:"",objectSeq:""})},[t,g]);const S=se({mutationFn:async()=>{const x={projectId:n,id:t==null?void 0:t.id,objectId:a.objectId,metadata:{towerType:a.towerType,trecho:a.trecho,tipoFundacao:a.tipoFundacao,totalConcreto:a.totalConcreto?parseFloat(a.totalConcreto):null,pesoArmacao:a.pesoArmacao?parseFloat(a.pesoArmacao):null,pesoEstrutura:a.pesoEstrutura?parseFloat(a.pesoEstrutura):null,tramoLancamento:a.tramoLancamento,tipificacaoEstrutura:a.tipificacaoEstrutura,goForward:a.goForward?parseFloat(a.goForward):null,technicalKm:a.technicalKm?parseFloat(a.technicalKm):null,objectSeq:a.objectSeq?parseInt(a.objectSeq):0}};return(await L.post("/tower_technical_data",[x])).data},onSuccess:()=>{y.invalidateQueries({queryKey:["production-towers"]}),A.success(t?"Torre atualizada com sucesso":"Torre adicionada com sucesso"),b()},onError:x=>{var w,E;A.error("Erro ao salvar torre: "+(((E=(w=x.response)==null?void 0:w.data)==null?void 0:E.message)||x.message))}}),c=x=>{const{name:w,value:E}=x.target;j(i=>({...i,[w]:E}))};return e.jsx(je,{open:g,onOpenChange:b,children:e.jsxs(fe,{className:"sm:max-w-[500px]",children:[e.jsxs(Ne,{children:[e.jsx(ve,{children:t?"Editar Torre":"Adicionar Nova Torre"}),e.jsx(we,{children:t?"Atualize os detalhes técnicos desta torre.":"Preencha as informações técnicas para cadastrar uma nova torre."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"objectId",children:"Número da Torre (ID)"}),e.jsx(I,{id:"objectId",name:"objectId",value:a.objectId,onChange:c,placeholder:"ex: 0/1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"trecho",children:"Trecho"}),e.jsx(I,{id:"trecho",name:"trecho",value:a.trecho,onChange:c,placeholder:"ex: L1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"objectSeq",children:"Sequência"}),e.jsx(I,{id:"objectSeq",name:"objectSeq",type:"number",value:a.objectSeq,onChange:c,placeholder:"ex: 1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"towerType",children:"Tipo de Torre"}),e.jsxs(de,{value:a.towerType,onValueChange:x=>j(w=>({...w,towerType:x})),children:[e.jsx(me,{children:e.jsx(xe,{placeholder:"Selecione o tipo"})}),e.jsxs(pe,{children:[e.jsx(H,{value:"Autoportante",children:"Autoportante"}),e.jsx(H,{value:"Estaiada",children:"Estaiada"}),e.jsx(H,{value:"Pórtico",children:"Pórtico"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"tipoFundacao",children:"Tipo de Fundação"}),e.jsx(I,{id:"tipoFundacao",name:"tipoFundacao",value:a.tipoFundacao,onChange:c,placeholder:"ex: Grelha"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"totalConcreto",children:"Concreto (m³)"}),e.jsx(I,{id:"totalConcreto",name:"totalConcreto",type:"number",step:"0.01",value:a.totalConcreto,onChange:c})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"pesoArmacao",children:"Armação (ton)"}),e.jsx(I,{id:"pesoArmacao",name:"pesoArmacao",type:"number",step:"0.001",value:a.pesoArmacao,onChange:c})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"pesoEstrutura",children:"Estrutura (ton)"}),e.jsx(I,{id:"pesoEstrutura",name:"pesoEstrutura",type:"number",step:"0.001",value:a.pesoEstrutura,onChange:c})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"tramoLancamento",children:"Tramo de Lançamento"}),e.jsx(I,{id:"tramoLancamento",name:"tramoLancamento",value:a.tramoLancamento,onChange:c})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"tipificacaoEstrutura",children:"Tipificação"}),e.jsx(I,{id:"tipificacaoEstrutura",name:"tipificacaoEstrutura",value:a.tipificacaoEstrutura,onChange:c})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"goForward",children:"Vão Vante (m)"}),e.jsx(I,{id:"goForward",name:"goForward",type:"number",step:"0.001",value:a.goForward,onChange:c,placeholder:"ex: 450"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"technicalKm",children:"KM Técnico"}),e.jsx(I,{id:"technicalKm",name:"technicalKm",type:"number",step:"0.001",value:a.technicalKm,onChange:c,placeholder:"ex: 12.450"})]})]})]}),e.jsxs(ye,{children:[e.jsx(k,{variant:"outline",onClick:b,disabled:S.isPending,children:"Cancelar"}),e.jsxs(k,{onClick:()=>S.mutate(),disabled:S.isPending,children:[S.isPending&&e.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"},"loader-icon"),t?"Salvar Alterações":"Criar Torre"]})]})]})})},Va=({isOpen:g,onClose:b,projectId:n})=>{const t=be(),[y,u]=h.useState(null),[N,a]=h.useState([]),[j,S]=h.useState(!1),c=se({mutationFn:async o=>{const d=o.map(s=>{const R=String(s.NumeroTorre||s["Número da Torre"]||s.Torre||""),C=String(s.Trecho||s.Subtrecho||""),O=parseFloat(s.Concreto||s["Total Concreto"]||s.Concreto_m3||s["Concreto (m3)"]||0);let P=parseFloat(s.PesoArmacao||s["Peso Armação"]||s.PesoArmacao_kg||s.PesoArmacao_ton||s["Peso Armação (kg)"]||0);(s.PesoArmacao_ton||s["Peso Armação (ton)"])&&(P*=1e3);const X=parseFloat(s.PesoEstrutura||s["Peso Estrutura"]||s.PesoEstrutura_ton||s.PesoEstrutura_kg||s["Peso Estrutura (ton)"]||0),F=parseFloat(s.VaoVante||s["Vão Vante"]||s.VaoVante_m||s.VaoVante_m_km||s["Vão Vante (m)"]||0);return{project_id:n,object_id:R,trecho:C,tower_type:s.TipoTorre||s["Tipo de Torre"]||"Autoportante",tipo_fundacao:s.TipoFundacao||s["Tipo de Fundação"]||"",total_concreto:O,peso_armacao:P,peso_estrutura:X,tramo_lancamento:String(s.TramoLancamento||s["Tramo de Lançamento"]||""),tipificacao_estrutura:String(s.TipificacaoEstrutura||s.Tipificação||""),object_seq:parseInt(s.Sequencia||s.Sequência||0),go_forward:F,metadata:{tower_type:s.TipoTorre||s["Tipo de Torre"]||"Autoportante",tipo_fundacao:s.TipoFundacao||s["Tipo de Fundação"]||"",total_concreto:O,peso_armacao:P,peso_estrutura:X,tramo_lancamento:String(s.TramoLancamento||s["Tramo de Lançamento"]||""),tipificacao_estrutura:String(s.TipificacaoEstrutura||s.Tipificação||""),go_forward:F,trecho:C,description:`Torre ${R} do trecho ${C}`}}}),m=50,_=[];for(let s=0;s<d.length;s+=m){const R=d.slice(s,s+m);console.log(`[Import] Enviando lote ${Math.floor(s/m)+1} (${R.length} torres)...`);const{data:C,error:O}=await L.from("tower_technical_data").insert(R);if(O)throw O;_.push(C),s+m<d.length&&await new Promise(P=>setTimeout(P,500))}return _},onSuccess:()=>{t.invalidateQueries({queryKey:["production-towers"]}),A.success("Torres importadas com sucesso!"),b(),setTimeout(()=>{u(null),a([])},100)},onError:o=>{var d,m;A.error("Erro na importação: "+(((m=(d=o.response)==null?void 0:d.data)==null?void 0:m.message)||o.message))}}),x=o=>{var m;const d=(m=o.target.files)==null?void 0:m[0];d&&(u(d),w(d))},w=o=>{S(!0);const d=new FileReader;d.onload=m=>{var P;const _=(P=m.target)==null?void 0:P.result,s=ja(_,{type:"binary"}),R=s.SheetNames[0],C=s.Sheets[R],O=ee.sheet_to_json(C);a(O),S(!1)},d.readAsBinaryString(o)},E=()=>{const o=[{Sequencia:1,Trecho:"TR-01",NumeroTorre:"0/1",VaoVante_m:450,TipoTorre:"Autoportante",TipoFundacao:"Grelha",Concreto_m3:15.5,PesoArmacao_ton:1.2,PesoEstrutura_ton:8.5,TramoLancamento:"T1",TipificacaoEstrutura:"A1"}],d=ee.json_to_sheet(o),m=ee.book_new();ee.book_append_sheet(m,d,"Modelo Importação"),ba(m,"Modelo_Importacao_Torres.xlsx")},i=()=>{N.length>0&&c.mutate(N)};return e.jsx(je,{open:g,onOpenChange:b,children:e.jsxs(fe,{className:"sm:max-w-[600px]",children:[e.jsxs(Ne,{children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Importar Torres via Excel"]}),e.jsx(we,{children:"Faça o upload de uma planilha para importar ou atualizar torres no projeto."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-4 border-2 border-dashed rounded-lg bg-muted/30 items-center justify-center hover:bg-muted/50 transition-colors cursor-pointer relative",children:[e.jsx(I,{type:"file",accept:".xlsx, .xls, .csv",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:x}),e.jsx(ce,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm font-medium",children:"Clique ou arraste o arquivo aqui"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formatos suportados: .xlsx, .xls, .csv"}),y&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-primary font-bold text-sm",children:[e.jsx(na,{className:"h-4 w-4"}),y.name]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-primary/5 p-3 rounded-md border border-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fa,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Baixe o modelo padrão. O campo **Vão Vante** deve ser informado em **metros**."})]}),e.jsxs(k,{variant:"outline",size:"sm",onClick:E,className:"gap-2",children:[e.jsx(Na,{className:"h-4 w-4"}),"Baixar Modelo"]})]}),j&&e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx(V,{className:"h-6 w-6 animate-spin text-primary"}),e.jsx("span",{className:"ml-2 text-sm",children:"Processando planilha..."})]}),N.length>0&&!j&&e.jsxs("div",{className:"max-h-[200px] overflow-auto border rounded-md",children:[e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{className:"bg-muted sticky top-0",children:e.jsx("tr",{children:Object.keys(N[0]).map(o=>e.jsx("th",{className:"p-2 border-b text-left",children:o},o))})}),e.jsx("tbody",{children:N.slice(0,5).map((o,d)=>e.jsx("tr",{children:Object.values(o).map((m,_)=>e.jsx("td",{className:"p-2 border-b",children:m},_))},d))})]}),N.length>5&&e.jsxs("p",{className:"text-[10px] text-muted-foreground p-2 text-center",children:["... e mais ",N.length-5," linhas"]})]})]}),e.jsxs(ye,{className:"flex items-center justify-between sm:justify-between",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N.length," torres detectadas na planilha."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"outline",onClick:b,disabled:c.isPending,children:"Cancelar"}),e.jsxs(k,{onClick:i,disabled:c.isPending||N.length===0,className:"gap-2",children:[c.isPending?e.jsx(V,{className:"h-4 w-4 animate-spin"},"loader-icon"):e.jsx(ce,{className:"h-4 w-4"},"upload-icon"),"Confirmar Importação"]})]})]})]})})};export{Ha as A,Va as E,Ga as T};
