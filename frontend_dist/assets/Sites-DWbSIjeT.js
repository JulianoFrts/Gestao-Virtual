import{f as ge,r as l,j as e,p as S,a3 as $,Y as pe,Z as xe,B as x,s as U,_ as ue,L as he,aN as fe,aO as je,aP as Ne,q as be,a4 as ve,$ as ye,N as we,a as Ce,u as Se,w as Le,aA as ke,ae as Ie,g as Ee,i as J,d as z,a0 as De,D as Oe,h as Pe,k as Ae,l as Te,m as _e,ax as te,o as Me,aw as re,S as He,G as Re,H as Ge,I as ze,J as Ue,aQ as Be,C as Fe,n as Ve}from"./index-D951x4H-.js";import{L as qe}from"./LoadingScreen-SEZW07K4.js";import{u as Je}from"./useSites-Dum3dnEP.js";import{I as O}from"./input-dNnkIPn6.js";import{C as Qe,b as Ze,c as $e,a as Ke}from"./card-BTHGlYFz.js";import{S as Y}from"./separator-B22JG5bU.js";import{P as le}from"./ProjectEmptyState-CRpC4Dgy.js";import{C as Xe}from"./ConfirmationDialog-96fSVVNc.js";import{S as W}from"./search-BoEw84GM.js";import{C as Ye}from"./circle-alert-BlgUQYiE.js";import{P as ee}from"./pencil-DX9IZKx2.js";import{C as We}from"./circle-help-B9f7_6g4.js";import{A as oe,a as ne,b as ie}from"./avatar-DBVYP3oo.js";import{C as es,a as ss,b as as,c as ts,d as rs,e as ls}from"./command-DzEVDCzR.js";import{C as os}from"./chevrons-up-down-BNQt7ayD.js";import{P as ns}from"./plus-DmkF01H_.js";import{L as ce}from"./layout-grid-4na9_LkO.js";import{L as de}from"./lock-BtTOdZOV.js";import{T as is}from"./trash-2-DD2QlM38.js";import{C as cs}from"./circle-user-BEeDl7ms.js";import"./upload-D2Q7C-3S.js";import"./alert-dialog-qR-bbYaw.js";import"./triangle-alert-BPKdZxxI.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],me=ge("ExternalLink",ds),ms=({value:f,latitude:n,longitude:u,onAddressChange:L,placeholder:B="Buscar endereço...",className:F,disabled:P=!1})=>{const[j,N]=l.useState(""),[A,b]=l.useState(!1),[d,g]=l.useState(!1),[T,k]=l.useState(String(n||"")),[a,i]=l.useState(String(u||"")),[I,D]=l.useState([]),[V,r]=l.useState(null),[v,C]=l.useState(!1),_=l.useRef(null),h=l.useRef(null),q=l.useRef(null);l.useEffect(()=>{typeof google<"u"&&google.maps&&google.maps.places&&(_.current=new google.maps.places.AutocompleteService,q.current&&(h.current=new google.maps.places.PlacesService(q.current)))},[]),l.useEffect(()=>{k(String(n||"")),i(String(u||""))},[n,u]);const M=l.useCallback(async o=>{if(N(o),r(null),o.length<3){D([]);return}if(!_.current){r("Serviço do Google Maps não disponível. Use a busca manual.");return}b(!0);try{const p=await new Promise((H,R)=>{_.current.getPlacePredictions({input:o,componentRestrictions:{country:"br"},types:["address"]},(E,s)=>{s===google.maps.places.PlacesServiceStatus.OK&&E?H(E):s===google.maps.places.PlacesServiceStatus.ZERO_RESULTS?H([]):R(new Error(`Places API error: ${s}`))})});D(p)}catch(p){console.error("Address search error:",p),r("Erro ao buscar endereços. Tente novamente ou use a opção manual."),D([])}finally{b(!1)}},[]),K=l.useCallback(o=>{if(!h.current){r("Serviço do Google Maps não disponível.");return}b(!0),h.current.getDetails({placeId:o.place_id,fields:["formatted_address","address_components","geometry"]},(p,H)=>{var R,E,s,t,c;if(b(!1),H===google.maps.places.PlacesServiceStatus.OK&&p){const m={formattedAddress:p.formatted_address||o.description,latitude:((E=(R=p.geometry)==null?void 0:R.location)==null?void 0:E.lat())||null,longitude:((t=(s=p.geometry)==null?void 0:s.location)==null?void 0:t.lng())||null};(c=p.address_components)==null||c.forEach(y=>{const w=y.types;w.includes("route")&&(m.street=y.long_name),w.includes("street_number")&&(m.number=y.long_name),(w.includes("sublocality")||w.includes("neighborhood"))&&(m.neighborhood=y.long_name),w.includes("administrative_area_level_2")&&(m.city=y.long_name),w.includes("administrative_area_level_1")&&(m.state=y.short_name),w.includes("postal_code")&&(m.postalCode=y.long_name)}),L(m),N(""),D([]),C(!1)}else r("Não foi possível obter detalhes do endereço.")})},[L]),X=()=>{const o=parseFloat(T),p=parseFloat(a);if(isNaN(o)||isNaN(p)){r("Coordenadas inválidas. Use formato decimal (ex: -23.5505, -46.6333).");return}L({formattedAddress:f||"Localização manual",latitude:o,longitude:p}),g(!1),r(null)},Q=()=>{window.open("https://www.google.com/maps","_blank")},Z=n&&u&&Number(n)!==0&&Number(u)!==0;return e.jsxs("div",{className:U("space-y-3",F),children:[e.jsx("div",{ref:q,style:{display:"none"}}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{className:"text-xs uppercase text-muted-foreground font-bold flex items-center gap-2",children:[e.jsx($,{className:"w-3.5 h-3.5 text-primary"}),"Endereço do Canteiro"]}),e.jsxs(pe,{open:v,onOpenChange:C,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(x,{variant:"outline",role:"combobox",disabled:P,className:U("w-full justify-start h-11 text-left font-normal","bg-primary/10 border-primary/30 hover:bg-primary/20 hover:border-primary/50","transition-all duration-200",!f&&"text-muted-foreground"),children:[e.jsx(W,{className:"mr-2 h-4 w-4 shrink-0 text-primary"}),f||B]})}),e.jsxs(ue,{className:"w-[400px] p-0 glass-card border-white/10",align:"start",children:[e.jsx("div",{className:"p-3 border-b border-white/10",children:e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Digite o endereço completo...",value:j,onChange:o=>M(o.target.value),className:"pl-9 industrial-input",autoFocus:!0}),A&&e.jsx(he,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 animate-spin text-primary"})]})}),I.length>0&&e.jsx("div",{className:"max-h-[200px] overflow-auto p-2",children:I.map(o=>e.jsxs(x,{variant:"ghost",className:"w-full justify-start text-left h-auto py-2 px-3 hover:bg-white/5",onClick:()=>K(o),children:[e.jsx($,{className:"mr-2 h-4 w-4 shrink-0 text-primary/60"}),e.jsx("span",{className:"truncate text-sm",children:o.description})]},o.place_id))}),j.length>=3&&I.length===0&&!A&&e.jsxs("div",{className:"p-4 text-center space-y-3",children:[e.jsx(Ye,{className:"w-8 h-8 mx-auto text-orange-400/60"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum endereço encontrado."}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",className:"border-orange-500/30 hover:bg-orange-500/10",onClick:()=>{g(!0),C(!1)},children:[e.jsx(ee,{className:"w-3.5 h-3.5 mr-2"}),"Digitar coordenadas manualmente"]}),e.jsxs(x,{variant:"ghost",size:"sm",onClick:Q,children:[e.jsx(me,{className:"w-3.5 h-3.5 mr-2"}),"Abrir Google Maps"]})]})]}),V&&e.jsx("div",{className:"p-3 bg-destructive/10 text-destructive text-sm border-t border-white/10",children:V})]})]})]}),(Z||d)&&e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border border-white/5 space-y-3 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"text-[10px] uppercase text-muted-foreground font-bold tracking-wider flex items-center gap-1.5",children:["Coordenadas Geográficas",e.jsxs(fe,{children:[e.jsx(je,{asChild:!0,children:e.jsx(We,{className:"w-3 h-3 text-muted-foreground/50 cursor-help"})}),e.jsx(Ne,{side:"top",className:"max-w-[250px]",children:e.jsx("p",{className:"text-xs",children:"Para obter as coordenadas: Abra o Google Maps, clique com o botão direito no local desejado e copie as coordenadas (ex: -23.5505, -46.6333)."})})]})]}),!d&&e.jsxs(x,{variant:"ghost",size:"sm",className:"h-6 text-xs",onClick:()=>g(!0),children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),"Editar"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(S,{className:"text-[10px] uppercase text-muted-foreground/60",children:"Latitude (X)"}),e.jsx(O,{type:"text",value:d?T:String(n||""),onChange:o=>k(o.target.value),disabled:!d,className:U("h-9 text-sm",d?"industrial-input":"bg-transparent border-none cursor-default"),placeholder:"-23.5505"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(S,{className:"text-[10px] uppercase text-muted-foreground/60",children:"Longitude (Y)"}),e.jsx(O,{type:"text",value:d?a:String(u||""),onChange:o=>i(o.target.value),disabled:!d,className:U("h-9 text-sm",d?"industrial-input":"bg-transparent border-none cursor-default"),placeholder:"-46.6333"})]})]}),d&&e.jsxs("div",{className:"flex gap-2 pt-1",children:[e.jsx(x,{variant:"outline",size:"sm",className:"flex-1 h-8 text-xs",onClick:()=>{g(!1),k(String(n||"")),i(String(u||""))},children:"Cancelar"}),e.jsx(x,{size:"sm",className:"flex-1 h-8 text-xs gradient-primary",onClick:X,children:"Aplicar"})]})]}),!Z&&!d&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:"Não encontrou o endereço?"}),e.jsx(x,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-primary",onClick:()=>g(!0),children:"Digitar coordenadas"}),e.jsx("span",{children:"ou"}),e.jsxs(x,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-primary",onClick:Q,children:[e.jsx(me,{className:"w-3 h-3 mr-1"}),"Abrir Google Maps"]})]})]})},ps=({users:f,selectedIds:n,onSelectionChange:u,placeholder:L="Selecionar responsáveis...",disabled:B=!1,className:F})=>{const[P,j]=l.useState(!1),[N,A]=l.useState(""),b=l.useMemo(()=>N?f.filter(a=>a.fullName.toLowerCase().includes(N.toLowerCase())):f,[f,N]),d=l.useMemo(()=>f.filter(a=>n.includes(a.id)),[f,n]),g=a=>{n.includes(a)?u(n.filter(i=>i!==a)):u([...n,a])},T=(a,i)=>{i.stopPropagation(),u(n.filter(I=>I!==a))},k=a=>a.split(" ").map(i=>i[0]).slice(0,2).join("").toUpperCase();return e.jsxs(pe,{open:P,onOpenChange:j,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(x,{variant:"outline",role:"combobox","aria-expanded":P,disabled:B,className:U("w-full justify-between h-auto min-h-11 py-2","bg-black/40 border-white/10 hover:bg-black/60 hover:border-primary/30","text-left font-normal",F),children:[d.length>0?e.jsx("div",{className:"flex flex-wrap gap-1.5",children:d.map(a=>e.jsxs(be,{variant:"secondary",className:"bg-primary/20 text-primary-foreground hover:bg-primary/30 pr-1 gap-1",children:[e.jsxs(oe,{className:"w-5 h-5 border border-white/10",children:[e.jsx(ne,{src:a.avatarUrl||void 0,alt:a.fullName}),e.jsx(ie,{className:"text-[8px] bg-primary/40",children:k(a.fullName)})]}),e.jsx("span",{className:"text-xs max-w-[100px] truncate",children:a.fullName.split(" ")[0]}),e.jsx(ve,{className:"w-3 h-3 ml-1 cursor-pointer hover:text-destructive",onClick:i=>T(a.id,i)})]},a.id))}):e.jsx("span",{className:"text-muted-foreground",children:L}),e.jsx(os,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ue,{className:"w-[300px] p-0 glass-card border-white/10",align:"start",children:e.jsxs(es,{className:"bg-transparent",children:[e.jsx(ss,{placeholder:"Buscar por nome...",value:N,onValueChange:A,className:"border-none focus:ring-0"}),e.jsxs(as,{children:[e.jsx(ts,{children:"Nenhum usuário encontrado."}),e.jsx(rs,{children:b.map(a=>{const i=n.includes(a.id);return e.jsxs(ls,{value:a.id,onSelect:()=>g(a.id),className:"cursor-pointer hover:bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs(oe,{className:"w-7 h-7 border border-white/10",children:[e.jsx(ne,{src:a.avatarUrl||void 0,alt:a.fullName}),e.jsx(ie,{className:"text-[9px] bg-muted",children:k(a.fullName)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a.fullName}),a.role&&e.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-wider",children:a.role})]})]}),e.jsx(ye,{className:U("w-4 h-4 ml-2",i?"opacity-100 text-primary":"opacity-0")})]},a.id)})})]})]})})]})};function Ms(){we();const f=Ce(),{profile:n}=Se(),{sites:u,isLoading:L,createSite:B,updateSite:F,deleteSite:P}=Je(),{projects:j,isLoading:N}=Le(),A=ke.useMemo(()=>({companyId:(n==null?void 0:n.companyId)||void 0}),[n==null?void 0:n.companyId]),{users:b,isLoading:d}=Ie(A),[g,T]=l.useState(""),[k,a]=l.useState(!1),[i,I]=l.useState(null),[D,V]=l.useState(!1),[r,v]=l.useState({name:"",projectId:"",locationDetails:"",plannedHours:0,xLat:0,yLa:0,responsibleIds:[]}),[C,_]=l.useState({open:!1,title:"",description:"",onConfirm:()=>{},variant:"default"}),[h,q]=l.useState("all"),{toast:M}=Ee(),K=J.value||z("sites.create"),X=async s=>{if(s.preventDefault(),!r.name.trim()||!r.projectId){M({title:"Aviso",description:"Nome e Obra são obrigatórios",variant:"destructive"});return}V(!0);try{const t={...r,plannedHours:Number(r.plannedHours),xLat:r.xLat?Number(r.xLat):null,yLa:r.yLa?Number(r.yLa):null};i?(await F(i.id,t)).success&&(M({title:"Canteiro atualizado!"}),o()):(await B(t)).success&&(M({title:"Canteiro cadastrado!"}),o())}finally{V(!1)}},Q=s=>{I(s),v({name:s.name,projectId:s.projectId,locationDetails:s.locationDetails||"",plannedHours:s.plannedHours||0,xLat:s.xLat||0,yLa:s.yLa||0,responsibleIds:s.responsibleIds||[]}),a(!0)},Z=async s=>{_({open:!0,title:"Excluir Canteiro",description:`Deseja realmente excluir o canteiro "${s.name}"? Esta ação não pode ser desfeita e removerá todos os registros associados.`,variant:"destructive",onConfirm:async()=>{(await P(s.id)).success&&M({title:"Canteiro excluído!"})}})},o=()=>{v({name:"",projectId:"",locationDetails:"",plannedHours:0,xLat:0,yLa:0,responsibleIds:[]}),I(null),a(!1)},p=s=>{var t;return((t=j.find(c=>c.id===s))==null?void 0:t.name)||"Obra desconhecida"},H=s=>b.filter(t=>t.role==="GESTOR_PROJECT"&&t.projectId===s),R=s=>b.filter(t=>t.role==="GESTOR_CANTEIRO"&&t.siteId===s),E=l.useMemo(()=>{let s=u.filter(c=>c.name.toLowerCase().includes(g.toLowerCase())||p(c.projectId).toLowerCase().includes(g.toLowerCase()));h&&h!=="all"&&(s=s.filter(c=>c.projectId===h));const t={};return s.forEach(c=>{t[c.projectId]||(t[c.projectId]=[]),t[c.projectId].push(c)}),t},[u,g,j,h]);return L||N||d?e.jsx(qe,{isLoading:!0,title:"GESTÃO DE CANTEIROS",message:"SINCRONIZANDO DADOS",details:[{label:"Canteiros",isLoading:L},{label:"Obras",isLoading:N},{label:"Usuários",isLoading:d}]}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold gradient-text",children:"Gestão de Canteiros"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie as frentes de trabalho organizadas por obra"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"w-[250px]",children:e.jsx(De,{value:h||"",onValueChange:q,showAll:!0})})}),K&&e.jsxs(Oe,{open:k,onOpenChange:s=>{a(s),s||o()},children:[e.jsx(Pe,{asChild:!0,children:e.jsxs(x,{className:"gradient-primary text-white shadow-glow",children:[e.jsx(ns,{className:"w-4 h-4 mr-2"}),"Novo Canteiro"]})}),e.jsxs(Ae,{className:"max-w-md",children:[e.jsxs(Te,{children:[e.jsxs(_e,{className:"flex items-center gap-2 text-2xl font-bold",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg gradient-primary flex items-center justify-center shadow-glow",children:e.jsx(te,{className:"text-white w-6 h-6"})}),i?"Editar Canteiro":"Novo Canteiro"]}),e.jsx(Me,{className:"text-muted-foreground pt-1",children:"Configure as áreas de trabalho vinculadas às obras."})]}),e.jsxs("form",{onSubmit:X,className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary font-semibold text-sm uppercase tracking-wider",children:[e.jsx(re,{className:"w-4 h-4"}),"Vínculo"]}),e.jsx(Y,{className:"bg-white/10"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-xs uppercase text-muted-foreground font-bold",children:"Obra Correspondente *"}),e.jsxs(He,{value:r.projectId,onValueChange:s=>v({...r,projectId:s}),children:[e.jsx(Re,{className:"industrial-input h-10",children:e.jsx(Ge,{placeholder:"Selecione a obra"})}),e.jsx(ze,{className:"glass-card border-white/10",children:j.map(s=>e.jsx(Ue,{value:s.id,children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-500 font-semibold text-sm uppercase tracking-wider",children:[e.jsx(ce,{className:"w-4 h-4"}),"Identificação do Canteiro"]}),e.jsx(Y,{className:"bg-white/10"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-xs uppercase text-muted-foreground font-bold",children:"Nome do Canteiro *"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{value:r.name,onChange:s=>v({...r,name:s.target.value}),className:"industrial-input h-10 pr-10",required:!0,placeholder:"Ex: Canteiro Sul, Torre A...",disabled:i&&!(J.value||z("sites.rename"))}),i&&!(J.value||z("sites.rename"))&&e.jsx(de,{className:"absolute right-3 top-2.5 w-4 h-4 text-orange-500/50"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-xs uppercase text-muted-foreground font-bold italic",children:"HHH Planejado"}),e.jsx(O,{type:"number",value:r.plannedHours,onChange:s=>v({...r,plannedHours:Number(s.target.value)}),className:"industrial-input h-10",placeholder:"Total Horas"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-xs uppercase text-muted-foreground font-bold",children:"Localização"}),e.jsx(O,{value:r.locationDetails,onChange:s=>v({...r,locationDetails:s.target.value}),className:"industrial-input h-10",placeholder:"Ex: Térreo"})]})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx(S,{className:"text-xs uppercase text-muted-foreground font-bold",children:"Responsáveis pelo Canteiro"}),e.jsx(ps,{users:b.filter(s=>s.role==="GESTOR_CANTEIRO"||s.role==="GESTOR_PROJECT"),selectedIds:r.responsibleIds,onSelectionChange:s=>v({...r,responsibleIds:s}),placeholder:"Selecionar gestores..."})]})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sky-400 font-semibold text-sm uppercase tracking-wider",children:[e.jsx($,{className:"w-4 h-4"}),"Localização Geográfica"]}),e.jsx(Y,{className:"bg-white/10"}),e.jsx(Be,{children:e.jsx(ms,{value:r.locationDetails,latitude:r.xLat,longitude:r.yLa,onAddressChange:s=>{v(t=>({...t,locationDetails:s.formattedAddress,xLat:s.latitude??t.xLat,yLa:s.longitude??t.yLa}))},placeholder:"Buscar endereço do canteiro..."})})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx(x,{type:"button",variant:"outline",onClick:o,className:"flex-1 h-11 border-white/10",children:"Cancelar"}),e.jsxs(x,{type:"submit",className:"flex-1 h-11 gradient-primary shadow-glow",disabled:D,children:[D?e.jsx(he,{className:"w-4 h-4 mr-2 animate-spin"}):null,i?"Salvar Alterações":"Cadastrar Canteiro"]})]})]})]})]})]}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Buscar por canteiro ou obra...",value:g,onChange:s=>T(s.target.value),className:"pl-10 industrial-input"})]}),e.jsx("div",{className:"space-y-10",children:!j||j.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[400px]",children:e.jsx(le,{type:"generic",title:"Nenhuma Obra Atribuída",description:"Sua empresa ainda não possui obras cadastradas. Cadastre ou vincule uma obra para gerenciar seus canteiros.",onAction:()=>f("/obras"),actionLabel:"Gerenciar Obras"})}):Object.keys(E).length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[400px]",children:e.jsx(le,{type:"sites",title:h&&h!=="all"?"Nenhum Canteiro nesta Obra":"Nenhum Canteiro Encontrado",description:h&&h!=="all"?"Esta obra ainda não possui canteiros cadastrados.":"Ainda não foram criados canteiros para as suas obras. Inicie as operações criando o primeiro canteiro.",onAction:()=>a(!0),actionLabel:"Criar Primeiro Canteiro"})}):Object.entries(E).map(([s,t])=>{const c=p(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 px-2",children:[e.jsxs("div",{className:"flex items-center gap-2 group cursor-default",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg gradient-primary flex items-center justify-center shadow-glow-sm",children:e.jsx(re,{className:"w-4 h-4 text-white"})}),e.jsx("h2",{className:"text-xl font-bold tracking-tight text-foreground/90 group-hover:text-primary transition-colors italic",children:c})]}),e.jsx("div",{className:"flex-1 h-px bg-linear-to-r from-primary/30 to-transparent"}),e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-muted-foreground/40 bg-muted/10 px-2 py-0.5 rounded",children:[t.length," ",t.length===1?"Canteiro":"Canteiros"]})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(m=>{var se;const y=H(m.projectId),w=R(m.id);return e.jsxs(Qe,{className:"group relative overflow-hidden glass-card border-white/5 hover:border-primary/20 transition-all duration-300",children:[e.jsx("div",{className:"absolute top-4 right-4 z-20 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(()=>{const G=J.value||z("sites.rename")||z("sites.update"),ae=J.value||z("sites.delete");return!G&&!ae?e.jsxs("div",{className:"h-8 flex items-center px-2 backdrop-blur-sm bg-black/20 rounded text-white/30",title:"Sem permissão hierárquica",children:[e.jsx(de,{className:"w-3.5 h-3.5 mr-1"}),e.jsx("span",{className:"text-[10px] uppercase font-bold",children:"Leitura"})]}):e.jsxs(e.Fragment,{children:[G&&e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary backdrop-blur-sm bg-black/20",onClick:()=>Q(m),children:e.jsx(ee,{className:"w-4 h-4"})}),ae&&e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive backdrop-blur-sm bg-black/20",onClick:()=>Z(m),children:e.jsx(is,{className:"w-4 h-4"})})]})})()}),e.jsx(Ze,{className:"pb-3 px-6 pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-primary/10 group-hover:bg-primary/20 transition-colors",children:e.jsx(te,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx($e,{className:"text-lg",children:m.name}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] uppercase font-bold text-muted-foreground tracking-wider",children:[e.jsx(ce,{className:"w-3 h-3"}),"Unidade de Trabalho"]})]})]})}),e.jsxs(Ke,{className:"space-y-5 px-6 pb-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 pb-4 border-b border-white/5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-black text-muted-foreground/60 italic",children:"Meta HHH"}),e.jsxs("p",{className:"text-sm font-black flex items-center gap-1.5 text-primary",children:[e.jsx(Fe,{className:"w-3.5 h-3.5"}),((se=m.plannedHours)==null?void 0:se.toLocaleString())||"0","h"]})]}),e.jsxs("div",{className:"space-y-1 text-right",children:[e.jsx("p",{className:"text-[10px] uppercase font-black text-muted-foreground/60 italic",children:"Status"}),e.jsx("span",{className:"text-[10px] font-bold bg-emerald-500/10 text-emerald-500 px-2 py-0.5 rounded-full border border-emerald-500/20",children:"Ativo"})]})]}),e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-primary/40"}),e.jsx("span",{className:"truncate italic",children:m.locationDetails||"Nenhum detalhe adicional"})]}),e.jsxs("div",{className:"pt-3 mt-2 border-t border-white/5 space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-white/30",children:"Gestor da Obra"}),e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded-lg bg-blue-500/5 border border-blue-500/10",children:[e.jsx(cs,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-xs font-semibold text-foreground/90",children:y.length>0?y.map(G=>G.fullName).join(", "):"Não atribuído"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-white/30",children:"Gestor do Canteiro"}),e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded-lg bg-orange-500/5 border border-orange-500/10",children:[e.jsx(Ve,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-xs font-semibold text-foreground/90",children:w.length>0?w.map(G=>G.fullName).join(", "):"Não atribuído"})]})]})]})]})]})]},m.id)})})]},s)})}),e.jsx(Xe,{open:C.open,onOpenChange:s=>_(t=>({...t,open:s})),title:C.title,description:C.description,onConfirm:C.onConfirm,variant:C.variant})]})}export{Ms as default};
