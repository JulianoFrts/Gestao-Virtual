import{c as k,ae as O,r as c,j as e,U as R,S as E,G as M,H as B,I as A,J as h,K as H,B as I,aK as $,q as K,D as G,k as J,l as P,m as Q,o as W,F as X}from"./index-D951x4H-.js";import{u as Y}from"./useDailyReports-BR6lQ8Fm.js";import{C as Z,b as _,c as ee,d as se,a as ae}from"./card-BTHGlYFz.js";import{I as U}from"./input-dNnkIPn6.js";import{T as te,a as re,b as u,c as n,d as le,e as i}from"./table-UwE0Vej1.js";import{C as q}from"./calendar-B3GVMfO3.js";import{S as ie}from"./search-BoEw84GM.js";import{E as ce}from"./eye-CxUjXe8h.js";import{f as ne}from"./format-CP1OFCPJ.js";import{p as F}from"./pt-BR-B9S-fQgu.js";function ge(){const{reports:N,isLoading:L}=Y(),{teams:g}=k(),{users:v}=O(),[d,y]=c.useState(""),[m,b]=c.useState("all"),[o,w]=c.useState("all"),[x,D]=c.useState(""),[a,S]=c.useState(null),p=(s,t,r)=>{try{const l=new Date(s);return isNaN(l.getTime())?"Data inválida":ne(l,t,r)}catch(l){return console.error("[Reports] Error formatting date:",s,l),"Erro na data"}},j=c.useMemo(()=>N.filter(s=>{let t=!0;if(d)try{t=new Date(s.reportDate).toISOString().split("T")[0]===d}catch{t=!1}const r=m!=="all"?s.teamId===m:!0,l=o!=="all"?s.createdBy===o:!0,C=x.toLowerCase(),z=x?(s.activities||"").toLowerCase().includes(C)||s.observations&&s.observations.toLowerCase().includes(C):!0;return t&&r&&l&&z}),[N,d,m,o,x]),f=s=>{if(!s)return"Desconhecido";const t=v.find(r=>r.id===s);return t?t.fullName:"Usuário não encontrado"},T=(s,t)=>{if(t)return t;const r=g.find(l=>l.id===s);return r?r.name:"Equipe não encontrada"};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center glass-card p-4 rounded-xl",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"})," Data"]}),e.jsx(U,{type:"date",className:"industrial-input",value:d,onChange:s=>y(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"})," Equipe"]}),e.jsxs(E,{value:m,onValueChange:b,children:[e.jsx(M,{className:"industrial-input",children:e.jsx(B,{placeholder:"Todas as equipes"})}),e.jsxs(A,{children:[e.jsx(h,{value:"all",children:"Todas as equipes"}),g.map(s=>e.jsx(h,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"})," Autor"]}),e.jsxs(E,{value:o,onValueChange:w,children:[e.jsx(M,{className:"industrial-input",children:e.jsx(B,{placeholder:"Todos os autores"})}),e.jsxs(A,{children:[e.jsx(h,{value:"all",children:"Todos os autores"}),v.map(s=>e.jsx(h,{value:s.id,children:s.fullName},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"})," Busca"]}),e.jsx(U,{placeholder:"Buscar no conteúdo...",className:"industrial-input",value:x,onChange:s=>D(s.target.value)})]})]}),e.jsx("div",{className:"flex items-end pt-2 md:pt-0",children:e.jsxs(I,{variant:"outline",onClick:()=>{y(""),b("all"),w("all"),D("")},className:"hover:text-primary transition-all",title:"Limpar filtros",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Limpar"]})})]}),e.jsxs(Z,{className:"glass-card",children:[e.jsxs(_,{children:[e.jsx(ee,{children:"Histórico de Relatórios"}),e.jsxs(se,{children:["Mostrando ",j.length," registro(s)"]})]}),e.jsx(ae,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs(u,{children:[e.jsx(n,{children:"Data"}),e.jsx(n,{children:"Equipe"}),e.jsx(n,{children:"Autor"}),e.jsx(n,{children:"Atividades"}),e.jsx(n,{className:"w-[100px]",children:"Ações"})]})}),e.jsx(le,{children:L?e.jsx(u,{children:e.jsx(i,{colSpan:5,className:"text-center py-8",children:"Carregando relatórios..."})}):j.length===0?e.jsx(u,{children:e.jsx(i,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"Nenhum relatório encontrado com os filtros selecionados."})}):j.map((s,t)=>e.jsxs(u,{children:[e.jsx(i,{children:p(s.reportDate,"dd 'de' MMMM",{locale:F})}),e.jsx(i,{children:e.jsx(K,{variant:"outline",className:"font-normal",children:T(s.teamId,s.teamName)})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-xs font-medium text-primary",children:f(s.createdBy).charAt(0)}),e.jsx("span",{className:"text-sm",children:f(s.createdBy)})]})}),e.jsx(i,{className:"max-w-[300px]",children:e.jsx("p",{className:"truncate text-sm text-muted-foreground",children:s.activities})}),e.jsx(i,{children:e.jsxs(I,{variant:"ghost",size:"sm",className:"hover:text-primary transition-all",onClick:()=>S(s),children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),"Ver"]})})]},`report-${s.id||s.localId}-${t}`))})]})})})]}),e.jsx(G,{open:!!a,onOpenChange:s=>!s&&S(null),children:e.jsxs(J,{className:"max-w-2xl",children:[e.jsxs(P,{children:[e.jsx(Q,{children:"Detalhes do Relatório"}),e.jsxs(W,{children:["Enviado em"," ",a&&p(a.createdAt,"dd/MM/yyyy 'às' HH:mm")]})]}),a&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Data de Referência"}),e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-primary"}),p(a.reportDate,"dd 'de' MMMM, yyyy",{locale:F})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Equipe"}),e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-primary"}),T(a.teamId,a.teamName)]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Enviado por"}),e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-primary"}),f(a.createdBy)]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status de Sincronização"}),e.jsx("p",{className:`font-medium text-sm flex items-center gap-2 ${a.syncedAt?"text-green-600":"text-amber-600"}`,children:a.syncedAt?"Sincronizado":"Pendente de envio"})]})]}),e.jsxs("div",{className:"space-y-2 p-4 bg-muted/30 rounded-lg border",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-primary"})," Atividades Realizadas"]}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:a.activities})]}),a.observations&&e.jsxs("div",{className:"space-y-2 p-4 bg-muted/30 rounded-lg border",children:[e.jsx("label",{className:"text-sm font-medium",children:"Observações"}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap text-muted-foreground",children:a.observations})]})]})]})})]})}export{ge as default};
