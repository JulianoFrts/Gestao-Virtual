import{f as b,j as e,ak as j,r as c,u as S,B as C,a$ as E}from"./index-D951x4H-.js";import{T,a as L,b as p,c as f}from"./tabs-D3Kawp4S.js";import{S as O}from"./scroll-area-C9sC2RNd.js";import{P as z}from"./play-Dfpf5oeu.js";import{C as _}from"./circle-alert-BlgUQYiE.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],g=b("CodeXml",q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],w=b("PanelsTopLeft",A),D=()=>{const[x,N]=c.useState('SELECT * FROM "users" LIMIT 100;'),[n,y]=c.useState([]),[v,h]=c.useState(!1),[o,i]=c.useState(null),{session:s}=S(),k=async()=>{var t;h(!0),i(null);try{const a="/api/v1",r=a.startsWith("http")?a:`${window.location.origin}${a.startsWith("/")?"":"/"}${a}`,m=(s==null?void 0:s.access_token)||(s==null?void 0:s.token)||((t=s==null?void 0:s.user)!=null&&t.id?"SESSION_COOKIE":""),u={"Content-Type":"application/json"};s!=null&&s.access_token&&(u.Authorization=`Bearer ${s.access_token}`);const d=await fetch(`${r}/db/query`,{method:"POST",headers:u,credentials:"include",body:JSON.stringify({query:x})});if(d.status===401)throw new Error("Sessão expirada ou não autorizada. Faça login novamente.");if(d.status===403)throw new Error("Você não tem permissão de Administrador para executar queries.");const l=await d.json();l.success?(y(Array.isArray(l.data)?l.data:[l.data]),E.success("Query executada com sucesso")):i(l.message||"Erro ao executar query")}catch(a){i(a.message)}finally{h(!1)}};return e.jsxs("div",{className:"flex flex-col h-full gap-4",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-zinc-950 rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-widest text-white/40",children:[e.jsx(g,{className:"w-4 h-4"}),"SQL Editor"]}),e.jsxs(C,{size:"sm",onClick:k,disabled:v,className:"bg-cyan-500 hover:bg-cyan-600 text-white gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Executar (F5)"]})]}),e.jsx("textarea",{value:x,onChange:t=>N(t.target.value),className:"flex-1 w-full p-4 bg-transparent text-cyan-50 font-mono text-sm resize-none focus:outline-none",spellCheck:!1})]}),e.jsxs("div",{className:"h-1/3 flex flex-col bg-zinc-900 rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center p-3 bg-white/5 border-b border-white/5 text-xs font-bold uppercase tracking-widest text-white/40 gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Resultados"]}),e.jsxs(O,{className:"flex-1",children:[o&&e.jsxs("div",{className:"p-4 flex items-center gap-3 text-red-400 bg-red-500/10 m-4 rounded-lg border border-red-500/20",children:[e.jsx(_,{className:"w-5 h-5 shrink-0"}),e.jsx("p",{className:"text-sm",children:o})]}),n.length>0?e.jsx("div",{className:"p-0",children:e.jsxs("table",{className:"w-full text-left text-xs border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-zinc-900 border-b border-white/10",children:e.jsx("tr",{children:Object.keys(n[0]).map(t=>e.jsx("th",{className:"p-3 font-bold text-white/60 border-r border-white/5 last:border-0",children:t},t))})}),e.jsx("tbody",{children:n.map((t,a)=>e.jsx("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:Object.values(t).map((r,m)=>e.jsx("td",{className:"p-3 text-white/80 font-mono border-r border-white/5 last:border-0 truncate max-w-[200px]",children:typeof r=="object"?JSON.stringify(r):String(r)},m))},a))})]})}):!o&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-white/20 gap-2 py-10",children:[e.jsx(j,{className:"w-12 h-12 opacity-10"}),e.jsx("p",{children:"Nenhum dado retornado ou query pendente"})]})]})]})]})};function R(){return e.jsxs("div",{className:"p-6 h-[calc(100vh-100px)] flex flex-col gap-6 animate-in fade-in duration-500",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-cyan-500/20 rounded-2xl border border-cyan-500/30",children:e.jsx(j,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-black uppercase tracking-tight text-white flex items-center gap-3",children:["Database Hub",e.jsx("span",{className:"text-[10px] bg-cyan-500/10 text-cyan-400 px-2 py-1 rounded-full border border-cyan-500/20 font-mono",children:"v1.2"})]}),e.jsx("p",{className:"text-sm text-white/40",children:"Gerenciamento interativo de dados e infraestrutura PostgreSQL"})]})]})}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsxs(T,{defaultValue:"console",className:"flex-1 flex flex-col min-h-0",children:[e.jsxs(L,{className:"bg-white/5 border border-white/10 p-1 mb-6 self-start rounded-xl",children:[e.jsxs(p,{value:"console",className:"data-[state=active]:bg-cyan-500 data-[state=active]:text-white gap-2 rounded-lg px-6",children:[e.jsx(g,{className:"w-4 h-4"}),"SQL Console"]}),e.jsxs(p,{value:"diagram",className:"data-[state=active]:bg-cyan-500 data-[state=active]:text-white gap-2 rounded-lg px-6",children:[e.jsx(w,{className:"w-4 h-4"}),"Diagram Designer (Em breve)"]})]}),e.jsx(f,{value:"console",className:"flex-1 mt-0",children:e.jsx(D,{})}),e.jsx(f,{value:"diagram",className:"flex-1 mt-0",children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/40",children:[e.jsx("p",{children:"O Designer de Diagramas está sendo otimizado para o seu ambiente."}),e.jsx("p",{className:"text-xs",children:"O SQL Console está totalmente operacional."})]})})]})})]})}export{R as default};
